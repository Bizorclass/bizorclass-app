"use strict";(self.webpackChunkfuse=self.webpackChunkfuse||[]).push([[604],{3604:(Je,w,o)=>{o.r(w),o.d(w,{TeachersModule:()=>v});var m=o(9299),b=o(4859),A=o(6709),Z=o(3238),D=o(9602),Q=o(4850),p=o(9549),k=o(7392),F=o(284),U=o(9506),N=o(8255),Y=o(3162),q=o(1948),M=o(4385),C=o(3267),R=o(7155),J=o(266),E=o(79),B=o(4466),e=o(4650);class _{canDeactivate(r,t,a,i){let c=i.root;for(;c.firstChild;)c=c.firstChild;return!(i.url.includes("/teachers")&&!c.paramMap.get("id"))||r.closeDrawer().then(()=>!0)}}_.\u0275fac=function(r){return new(r||_)},_.\u0275prov=e.Yz7({token:_,factory:_.\u0275fac,providedIn:"root"});class T{constructor(){}}T.\u0275fac=function(r){return new(r||T)},T.\u0275cmp=e.Xpm({type:T,selectors:[["teachers"]],decls:1,vars:0,template:function(r,t){1&r&&e._UZ(0,"router-outlet")},dependencies:[m.lC],encapsulation:2,changeDetection:0});var f=o(6895),s=o(4006),L=o(7579),I=o(2722),z=o(4968),H=o(9300),O=o(5830),G=o(4880);const K=["matDrawer"];function P(n,r){if(1&n&&(e.ynx(0),e._uU(1),e.BQk()),2&n){const t=e.oxw();e.xp6(1),e.hij(" ",null==t.teacherServerList?null:t.teacherServerList.length," ")}}function W(n,r){if(1&n&&(e.ynx(0),e.TgZ(1,"div",26),e._uU(2),e.qZA(),e.BQk()),2&n){const t=e.oxw().$implicit;e.xp6(2),e.hij(" ",t.first_name.charAt(0)," ")}}function $(n,r){if(1&n&&(e.ynx(0),e._UZ(1,"img",27),e.BQk()),2&n){const t=e.oxw().$implicit;e.xp6(1),e.Q6J("src",null==t?null:t.photo_url,e.LSH)}}function V(n,r){if(1&n&&(e.ynx(0),e.TgZ(1,"div",28),e._uU(2),e.qZA(),e.BQk()),2&n){const t=e.oxw().$implicit;e.xp6(2),e.hij(" ",t.first_name.charAt(0)," ")}}const X=function(n,r){return{"hover:bg-gray-100 dark:hover:bg-hover":n,"bg-primary-50 dark:bg-hover":r}},ee=function(n){return["./",n]};function te(n,r){if(1&n&&(e.ynx(0),e.YNc(1,W,3,1,"ng-container",9),e.TgZ(2,"a",21)(3,"div",22),e.YNc(4,$,2,1,"ng-container",9),e.YNc(5,V,3,1,"ng-container",9),e.qZA(),e.TgZ(6,"div",23)(7,"div",24),e._uU(8),e.qZA(),e.TgZ(9,"div",25),e._uU(10),e.qZA()()(),e.BQk()),2&n){const t=r.$implicit,a=r.index,i=e.oxw(3);e.xp6(1),e.Q6J("ngIf",0===a||t.first_name.charAt(0)!==i.teacherList[a-1].first_name.charAt(0)),e.xp6(1),e.Q6J("ngClass",e.WLB(7,X,!i.selectedContact||i.selectedContact.id!==t.teacher_id,i.selectedContact&&i.selectedContact.id===t.teacher_id))("routerLink",e.VKq(10,ee,t.teacher_id)),e.xp6(2),e.Q6J("ngIf",null==t?null:t.photo_url),e.xp6(1),e.Q6J("ngIf",!(null!=t&&t.photo_url)),e.xp6(3),e.hij(" ",t.first_name+" "+t.last_name," "),e.xp6(2),e.hij(" ",null==t?null:t.email," ")}}function re(n,r){if(1&n&&(e.ynx(0),e.YNc(1,te,11,12,"ng-container",20),e.BQk()),2&n){const t=e.oxw(2);e.xp6(1),e.Q6J("ngForOf",t.teacherList)("ngForTrackBy",t.trackByFn)}}function ne(n,r){if(1&n&&(e.ynx(0),e.YNc(1,re,2,2,"ng-container",19),e.BQk()),2&n){const t=e.oxw(),a=e.MAs(27);e.xp6(1),e.Q6J("ngIf",t.teacherList.length)("ngIfElse",a)}}function ae(n,r){1&n&&(e.TgZ(0,"div",29),e._uU(1," There are no teachers! "),e.qZA())}const ie=function(){return{"=0":"No teachers","=1":"teacherItem",other:"teachers"}};class x{constructor(r,t,a,i,c,l){this._activatedRoute=r,this._changeDetectorRef=t,this.apiService=a,this._document=i,this._router=c,this._fuseMediaWatcherService=l,this.teacherServerList=null,this.teacherList=[],this.searchInputControl=new s.p4,this._unsubscribeAll=new L.x}ngOnInit(){this.getCourseAndSubjectsListFromServer(),this.getTeacherListFromServer(),this.searchInputControl.valueChanges.subscribe(r=>{this.teacherList=this.teacherServerList.map(t=>({...t,name:`${t.first_name} ${t.last_name}`.toLowerCase()})).filter(t=>t.name.includes(r.toLowerCase()))}),this.matDrawer.openedChange.subscribe(r=>{r||(this.selectedContact=null,this._changeDetectorRef.markForCheck())}),this._fuseMediaWatcherService.onMediaChange$.pipe((0,I.R)(this._unsubscribeAll)).subscribe(({matchingAliases:r})=>{this.drawerMode=r.includes("lg")?"side":"over",this._changeDetectorRef.markForCheck()}),(0,z.R)(this._document,"keydown").pipe((0,I.R)(this._unsubscribeAll),(0,H.h)(r=>(!0===r.ctrlKey||r.metaKey)&&"/"===r.key)).subscribe(()=>{this.createContact()})}ngOnDestroy(){this._unsubscribeAll.next(null),this._unsubscribeAll.complete()}getTeacherListFromServer(){this.apiService.getTeacherList().subscribe(r=>{console.log(r),r&&(this.teacherList=[...r],this.teacherServerList=[...r],this._changeDetectorRef.markForCheck())},r=>{console.log(r)})}getCourseAndSubjectsListFromServer(){}onBackdropClicked(){this._router.navigate(["./"],{relativeTo:this._activatedRoute}),this._changeDetectorRef.markForCheck()}createContact(){this._router.navigate(["./","createTeacher"],{relativeTo:this._activatedRoute})}trackByFn(r,t){return t.id||r}}x.\u0275fac=function(r){return new(r||x)(e.Y36(m.gz),e.Y36(e.sBO),e.Y36(O.s),e.Y36(f.K0),e.Y36(m.F0),e.Y36(G.T))},x.\u0275cmp=e.Xpm({type:x,selectors:[["teachers-list"]],viewQuery:function(r,t){if(1&r&&e.Gf(K,7),2&r){let a;e.iGM(a=e.CRH())&&(t.matDrawer=a.first)}},decls:28,vars:17,consts:[[1,"absolute","inset-0","flex","flex-col","min-w-0","overflow-hidden"],[1,"flex-auto","h-full","bg-card","dark:bg-transparent",3,"backdropClick"],[1,"w-full","md:w-160","dark:bg-gray-900",3,"mode","opened","position","disableClose"],["matDrawer",""],[1,"flex","flex-col"],[1,"flex-auto"],[1,"flex","flex-col","sm:flex-row","md:flex-col","flex-auto","justify-between","py-8","px-6","md:px-8","border-b"],[1,"text-4xl","font-extrabold","tracking-tight","leading-none"],[1,"ml-0.5","font-medium","text-secondary"],[4,"ngIf"],[1,"flex","items-center","mt-4","sm:mt-0","md:mt-4"],["subscriptSizing","dynamic",1,"fuse-mat-dense","fuse-mat-rounded","w-full","min-w-50"],["matPrefix","",1,"icon-size-5",3,"svgIcon"],["matInput","",3,"formControl","autocomplete","placeholder"],["mat-flat-button","",1,"ml-4",3,"color","click"],[3,"svgIcon"],[1,"ml-2","mr-1"],[1,"relative"],["noAdmins",""],[4,"ngIf","ngIfElse"],[4,"ngFor","ngForOf","ngForTrackBy"],[1,"z-20","flex","items-center","px-6","py-4","md:px-8","cursor-pointer","border-b",3,"ngClass","routerLink"],[1,"flex","flex-0","items-center","justify-center","w-10","h-10","rounded-full","overflow-hidden"],[1,"min-w-0","ml-4"],[1,"font-medium","leading-5","truncate"],[1,"leading-5","truncate","text-secondary"],[1,"z-10","sticky","top-0","-mt-px","px-6","py-1","md:px-8","border-t","border-b","font-medium","uppercase","text-secondary","bg-gray-50","dark:bg-gray-900"],["alt","Contact avatar",1,"object-cover","w-full","h-full",3,"src"],[1,"flex","items-center","justify-center","w-full","h-full","rounded-full","text-lg","uppercase","bg-gray-200","text-gray-600","dark:bg-gray-700","dark:text-gray-200"],[1,"p-8","sm:p-16","border-t","text-4xl","font-semibold","tracking-tight","text-center"]],template:function(r,t){1&r&&(e.TgZ(0,"div",0)(1,"mat-drawer-container",1),e.NdJ("backdropClick",function(){return t.onBackdropClicked()}),e.TgZ(2,"mat-drawer",2,3),e._UZ(4,"router-outlet"),e.qZA(),e.TgZ(5,"mat-drawer-content",4)(6,"div",5)(7,"div",6)(8,"div")(9,"div",7),e._uU(10," Teachers "),e.qZA(),e.TgZ(11,"div",8),e.YNc(12,P,2,1,"ng-container",9),e._uU(13),e.ALo(14,"i18nPlural"),e.qZA()(),e.TgZ(15,"div",10)(16,"div",5)(17,"mat-form-field",11),e._UZ(18,"mat-icon",12)(19,"input",13),e.qZA()(),e.TgZ(20,"button",14),e.NdJ("click",function(){return t.createContact()}),e._UZ(21,"mat-icon",15),e.TgZ(22,"span",16),e._uU(23,"Add"),e.qZA()()()(),e.TgZ(24,"div",17),e.YNc(25,ne,2,2,"ng-container",9),e.YNc(26,ae,2,0,"ng-template",null,18,e.W1O),e.qZA()()()()()),2&r&&(e.xp6(2),e.Q6J("mode",t.drawerMode)("opened",!1)("position","end")("disableClose",!0),e.xp6(10),e.Q6J("ngIf",(null==t.teacherServerList?null:t.teacherServerList.length)>0),e.xp6(1),e.hij(" ",e.xi3(14,13,null==t.teacherServerList?null:t.teacherServerList.length,e.DdM(16,ie))," "),e.xp6(5),e.Q6J("svgIcon","heroicons_solid:search"),e.xp6(1),e.Q6J("formControl",t.searchInputControl)("autocomplete","off")("placeholder","Search teachers"),e.xp6(1),e.Q6J("color","primary"),e.xp6(1),e.Q6J("svgIcon","heroicons_outline:plus"),e.xp6(4),e.Q6J("ngIf",t.teacherList.length>0))},dependencies:[m.lC,m.rH,b.lW,p.KE,p.qo,k.Hw,F.Nt,C.jA,C.kh,C.LW,f.mk,f.sg,f.O5,s.Fj,s.JJ,s.oH,f.Gx],encapsulation:2,changeDetection:0});var y=o(5861),oe=o(7759),ce=o(7401),se=o(8184),le=o(1481);const ue=["avatarFileInput"];function de(n,r){if(1&n&&(e.ynx(0),e._UZ(1,"img",18),e.BQk()),2&n){const t=e.oxw(2);e.xp6(1),e.Q6J("src",null==t.teacherObject?null:t.teacherObject.background,e.LSH)}}function me(n,r){if(1&n&&e._UZ(0,"img",19),2&n){const t=e.oxw(2);e.Q6J("src",null==t.teacherObject?null:t.teacherObject.avatar,e.LSH)}}function he(n,r){if(1&n&&(e.TgZ(0,"div",20),e._uU(1),e.qZA()),2&n){const t=e.oxw(2);e.xp6(1),e.hij(" ",null==t.teacherObject||null==t.teacherObject.first_name?null:t.teacherObject.first_name.charAt(0)," ")}}function pe(n,r){if(1&n&&(e.ynx(0),e.TgZ(1,"div",21),e._UZ(2,"mat-icon",22),e.TgZ(3,"div",23)(4,"div",24)(5,"a",25),e._uU(6),e.qZA()()()(),e.BQk()),2&n){const t=e.oxw(2);e.xp6(2),e.Q6J("svgIcon","heroicons_outline:mail"),e.xp6(3),e.Q6J("href","mailto:"+(null==t.teacherObject?null:t.teacherObject.email),e.LSH),e.xp6(1),e.hij(" ",null==t.teacherObject?null:t.teacherObject.email," ")}}const S=function(){return["../"]};function ge(n,r){if(1&n){const t=e.EpF();e.ynx(0),e.TgZ(1,"div",2),e.YNc(2,de,2,1,"ng-container",1),e.TgZ(3,"div",3)(4,"a",4),e._UZ(5,"mat-icon",5),e.qZA()()(),e.TgZ(6,"div",6)(7,"div",7)(8,"div",8)(9,"div",9),e.YNc(10,me,1,1,"img",10),e.YNc(11,he,2,1,"div",11),e.qZA(),e.TgZ(12,"div",12)(13,"button",13),e.NdJ("click",function(){e.CHM(t);const i=e.oxw();return e.KtG(i.toggleEditMode(!0))}),e._UZ(14,"mat-icon",14),e.TgZ(15,"span",15),e._uU(16,"Edit"),e.qZA()()()(),e.TgZ(17,"div",16),e._uU(18),e.qZA(),e.TgZ(19,"div",17),e.YNc(20,pe,7,3,"ng-container",1),e.qZA()()(),e.BQk()}if(2&n){const t=e.oxw();e.xp6(2),e.Q6J("ngIf",null==t.teacherObject?null:t.teacherObject.background),e.xp6(2),e.Q6J("matTooltip","Close")("routerLink",e.DdM(10,S)),e.xp6(1),e.Q6J("svgIcon","heroicons_outline:x"),e.xp6(5),e.Q6J("ngIf",null==t.teacherObject?null:t.teacherObject.avatar),e.xp6(1),e.Q6J("ngIf",!(null!=t.teacherObject&&t.teacherObject.avatar)),e.xp6(3),e.Q6J("svgIcon","heroicons_solid:pencil-alt"),e.xp6(4),e.AsE("",null==t.teacherObject?null:t.teacherObject.first_name," ",null==t.teacherObject?null:t.teacherObject.last_name,""),e.xp6(2),e.Q6J("ngIf",null==t.teacherObject?null:t.teacherObject.email)}}function fe(n,r){if(1&n&&(e.ynx(0),e._UZ(1,"img",18),e.BQk()),2&n){const t=e.oxw(2);e.xp6(1),e.Q6J("src",null==t.teacherObject?null:t.teacherObject.background,e.LSH)}}function _e(n,r){if(1&n&&e._UZ(0,"img",19),2&n){const t=e.oxw(2);e.Q6J("src",t.avatarObject?t.imageFileTOString(t.avatarObject):null==t.teacherObject?null:t.teacherObject.avatar,e.LSH)}}function xe(n,r){if(1&n&&(e.TgZ(0,"div",20),e._uU(1),e.qZA()),2&n){const t=e.oxw(2);e.xp6(1),e.hij(" ",null==t.teacherObject?null:t.teacherObject.first_name.charAt(0)," ")}}function ve(n,r){1&n&&(e.TgZ(0,"mat-error"),e._uU(1," Email address is required "),e.qZA())}function be(n,r){1&n&&(e.TgZ(0,"mat-error"),e._uU(1," Please enter a valid email address "),e.qZA())}function Te(n,r){1&n&&e._UZ(0,"mat-icon",14),2&n&&e.Q6J("svgIcon","heroicons_solid:eye")}function ye(n,r){1&n&&e._UZ(0,"mat-icon",14),2&n&&e.Q6J("svgIcon","heroicons_solid:eye-off")}function je(n,r){if(1&n&&(e.TgZ(0,"mat-error"),e._uU(1),e.qZA()),2&n){const t=e.oxw(3);e.xp6(1),e.hij(" ",t.teacherForm.get("password").errors.passwordValidator," ")}}function Ce(n,r){if(1&n){const t=e.EpF();e.TgZ(0,"div",35)(1,"mat-form-field",51)(2,"mat-label"),e._uU(3,"Password"),e.qZA(),e._UZ(4,"input",52,53),e.TgZ(6,"button",54),e.NdJ("click",function(){e.CHM(t);const i=e.MAs(5);return e.KtG(i.type="password"===i.type?"text":"password")}),e.YNc(7,Te,1,1,"mat-icon",55),e.YNc(8,ye,1,1,"mat-icon",55),e.qZA(),e.YNc(9,je,2,1,"mat-error",1),e.qZA()()}if(2&n){const t=e.MAs(5),a=e.oxw(2);e.xp6(4),e.Q6J("formControlName","password"),e.xp6(3),e.Q6J("ngIf","password"===t.type),e.xp6(1),e.Q6J("ngIf","text"===t.type),e.xp6(1),e.Q6J("ngIf",a.teacherForm.get("password").hasError("passwordValidator"))}}function Ze(n,r){if(1&n){const t=e.EpF();e.TgZ(0,"div",60)(1,"mat-checkbox",61,62),e.NdJ("change",function(){const c=e.CHM(t).$implicit,l=e.oxw(3);return e.KtG(l.onSubjectChange(c))}),e._uU(3),e.qZA()()}if(2&n){const t=r.$implicit,a=e.oxw(3);e.xp6(1),e.Q6J("checked",a.isCheckedSubject(t,a.teacherForm.get("subjects")))("color","primary"),e.xp6(2),e.hij(" ",t.title," ")}}function ke(n,r){if(1&n&&(e.TgZ(0,"div",56)(1,"span",57),e._uU(2),e.qZA(),e.TgZ(3,"div",58),e.YNc(4,Ze,4,3,"div",59),e.qZA()()),2&n){const t=r.$implicit;e.xp6(2),e.Oqu(t.title),e.xp6(2),e.Q6J("ngForOf",null==t?null:t.subjects)}}function Fe(n,r){if(1&n){const t=e.EpF();e.ynx(0),e.TgZ(1,"div",2),e.YNc(2,fe,2,1,"ng-container",1),e.TgZ(3,"div",3)(4,"a",26),e._UZ(5,"mat-icon",5),e.qZA()()(),e.TgZ(6,"div",27)(7,"div",7)(8,"form",28)(9,"div",8)(10,"div",29),e._UZ(11,"div",30),e.TgZ(12,"div",31)(13,"div")(14,"input",32,33),e.NdJ("change",function(){e.CHM(t);const i=e.MAs(15),c=e.oxw();return e.KtG(c.uploadAvatar(i.files))}),e.qZA(),e.TgZ(16,"label",34),e._UZ(17,"mat-icon",5),e.qZA()()(),e.YNc(18,_e,1,1,"img",10),e.YNc(19,xe,2,1,"div",11),e.qZA()(),e.TgZ(20,"div",35)(21,"mat-form-field",36)(22,"mat-label"),e._uU(23,"First Name"),e.qZA(),e._UZ(24,"mat-icon",37)(25,"input",38),e.TgZ(26,"mat-error"),e._uU(27," First name is required "),e.qZA()()(),e.TgZ(28,"div",35)(29,"mat-form-field",36)(30,"mat-label"),e._uU(31,"Last Name"),e.qZA(),e._UZ(32,"mat-icon",37)(33,"input",38),e.TgZ(34,"mat-error"),e._uU(35," Last name is required "),e.qZA()()(),e.TgZ(36,"div",35)(37,"mat-form-field",36)(38,"mat-label"),e._uU(39,"Email"),e.qZA(),e._UZ(40,"mat-icon",37)(41,"input",39),e.YNc(42,ve,2,0,"mat-error",1),e.YNc(43,be,2,0,"mat-error",1),e.qZA()(),e.YNc(44,Ce,10,4,"div",40),e.TgZ(45,"div",35)(46,"mat-form-field",36)(47,"mat-label"),e._uU(48,"Year of experience"),e.qZA(),e._UZ(49,"input",41),e.TgZ(50,"mat-error"),e._uU(51," Year of experience is required "),e.qZA()()(),e.TgZ(52,"div",35)(53,"mat-form-field",36)(54,"mat-label"),e._uU(55,"Degree"),e.qZA(),e._UZ(56,"input",42),e.TgZ(57,"mat-error"),e._uU(58," Degree is required "),e.qZA()()(),e.TgZ(59,"div",35)(60,"mat-form-field",36)(61,"mat-label"),e._uU(62,"About description"),e.qZA(),e._UZ(63,"textarea",42),e.TgZ(64,"mat-error"),e._uU(65," About description is required "),e.qZA()()(),e.TgZ(66,"div",35)(67,"mat-form-field",36)(68,"mat-label"),e._uU(69,"Linkein link"),e.qZA(),e._UZ(70,"input",42),e.TgZ(71,"mat-error"),e._uU(72," Linkein link is required "),e.qZA()()(),e.TgZ(73,"div",43)(74,"div",44)(75,"p",45),e._uU(76,"Subjects"),e.qZA()(),e._UZ(77,"mat-divider"),e.TgZ(78,"div",46),e.YNc(79,ke,5,2,"div",47),e.qZA()(),e.TgZ(80,"div",48)(81,"button",49),e.NdJ("click",function(){e.CHM(t);const i=e.oxw();return e.KtG(null!=i.teacherObject&&i.teacherObject.teacher_id?i.toggleEditMode(!1):i.goBack())}),e._uU(82," Cancel "),e.qZA(),e.TgZ(83,"button",50),e.NdJ("click",function(){e.CHM(t);const i=e.oxw();return e.KtG(i.updateContact())}),e._uU(84," Save "),e.qZA()()()()(),e.BQk()}if(2&n){const t=e.oxw();e.xp6(2),e.Q6J("ngIf",null==t.teacherObject?null:t.teacherObject.background),e.xp6(2),e.Q6J("matTooltip","Close")("routerLink",e.DdM(49,S)),e.xp6(1),e.Q6J("svgIcon","heroicons_outline:x"),e.xp6(3),e.Q6J("formGroup",t.teacherForm),e.xp6(6),e.Q6J("multiple",!1)("accept","image/jpeg, image/png"),e.xp6(3),e.Q6J("svgIcon","heroicons_outline:camera"),e.xp6(1),e.Q6J("ngIf",t.avatarObject||(null==t.teacherObject?null:t.teacherObject.avatar)),e.xp6(1),e.Q6J("ngIf",!(null!=t.teacherObject&&t.teacherObject.avatar)),e.xp6(2),e.Q6J("subscriptSizing","dynamic"),e.xp6(3),e.Q6J("svgIcon","heroicons_solid:user-circle"),e.xp6(1),e.Q6J("formControlName","first_name")("placeholder","First Name")("spellcheck",!1),e.xp6(4),e.Q6J("subscriptSizing","dynamic"),e.xp6(3),e.Q6J("svgIcon","heroicons_solid:user-circle"),e.xp6(1),e.Q6J("formControlName","last_name")("placeholder","Last Name")("spellcheck",!1),e.xp6(4),e.Q6J("subscriptSizing","dynamic"),e.xp6(3),e.Q6J("svgIcon","heroicons_solid:mail"),e.xp6(1),e.Q6J("formControlName","email")("placeholder","Email address")("spellcheck",!1),e.xp6(1),e.Q6J("ngIf",t.teacherForm.get("email").hasError("required")),e.xp6(1),e.Q6J("ngIf",t.teacherForm.get("email").hasError("email")),e.xp6(1),e.Q6J("ngIf",!(null!=t.teacherObject&&t.teacherObject.teacher_id)),e.xp6(2),e.Q6J("subscriptSizing","dynamic"),e.xp6(3),e.Q6J("formControlName","year_experience")("placeholder","Year of experience")("spellcheck",!1),e.xp6(4),e.Q6J("subscriptSizing","dynamic"),e.xp6(3),e.Q6J("formControlName","degree")("placeholder","Degree")("spellcheck",!1),e.xp6(4),e.Q6J("subscriptSizing","dynamic"),e.xp6(3),e.Q6J("formControlName","about_description")("placeholder","About description")("spellcheck",!1),e.xp6(4),e.Q6J("subscriptSizing","dynamic"),e.xp6(3),e.Q6J("formControlName","linkedin_link")("placeholder","Linkein link")("spellcheck",!1),e.xp6(9),e.Q6J("ngForOf",t.serverCoursesAndSubject),e.xp6(2),e.Q6J("matTooltip","Cancel"),e.xp6(2),e.Q6J("disabled",t.teacherForm.invalid)("color","primary")("matTooltip","Save")}}class j{constructor(r,t,a,i,c,l,d,g,h,u,Ae){this._activatedRoute=r,this._changeDetectorRef=t,this._teachersListComponent=a,this.apiService=i,this._formBuilder=c,this._fuseConfirmationService=l,this._renderer2=d,this._router=g,this._overlay=h,this._viewContainerRef=u,this.domSanitizer=Ae,this.editMode=!1,this.serverCoursesAndSubject=[],this.teacher_id=null,this.avatarObject=null,this._unsubscribeAll=new L.x,this.getCoursesAndSubjectFromServer(),this._activatedRoute.params.subscribe(Qe=>{this.teacher_id=Qe.id,"createTeacher"===this.teacher_id?this.toggleEditMode(!0):this.getTeacherFromServer()})}ngOnInit(){this._teachersListComponent.matDrawer.open(),this.resetTeacherForm()}resetTeacherForm(){this.teacherForm&&(this.teacherForm=null),this.teacherForm=this._formBuilder.group({first_name:["",s.kI.required],last_name:["",s.kI.required],email:["",[s.kI.required,s.kI.email]],year_experience:["",s.kI.required],degree:["",s.kI.required],about_description:["",s.kI.required],linkedin_link:["",s.kI.required],subjects:this._formBuilder.array([]),password:["",(0,oe.y)()]})}ngOnDestroy(){this._unsubscribeAll.next(null),this._unsubscribeAll.complete()}getCoursesAndSubjectFromServer(){var r=this;this.apiService.getAllActiveCourseWithSubject().subscribe(function(){var t=(0,y.Z)(function*(a){if(console.log(a),a.data){let c=a.data.filter(l=>l?.subject?.length>0);for(var i=0;i<c.length;i++)c[i].subjects=c[i].subject,delete c[i].subject;r.serverCoursesAndSubject=[...c],console.log(r.serverCoursesAndSubject)}});return function(a){return t.apply(this,arguments)}}(),t=>{console.log(t)})}getTeacherFromServer(){var r=this;this.apiService.getTeacherById(this.teacher_id).subscribe(function(){var t=(0,y.Z)(function*(a){if(console.log(a),a.data){r.toggleEditMode(!1);let i=Array.isArray(a.data)?a.data[0]:a.data;i.subjects=i["teacher-subject"],delete i["teacher-subject"],r.teacherObject=i,r._changeDetectorRef.markForCheck(),console.log(r.teacherObject),r.resetTeacherForm()}});return function(a){return t.apply(this,arguments)}}(),t=>{console.log(t)})}onSubjectChange(r){if(console.log(r),this.teacherForm.get("subjects").value.find(t=>t.subject_id===r.subject_id)){const t=this.teacherForm.get("subjects").value.findIndex(i=>i.subject_id===r.subject_id);this.teacherForm.get("subjects").removeAt(t)}else{const t=this._formBuilder.group({subject_id:[r.subject_id,[s.kI.required]],teacher_id:[this.teacher_id,[s.kI.required]],price:[NaN]});this.teacherForm.get("subjects").push(t)}this._changeDetectorRef.markForCheck(),console.log(this.teacherForm),console.log(this.teacherForm.get("subjects").value)}isCheckedSubject(r,t){return Boolean(t.value.find(a=>a.subject_id===r.subject_id))}isPriceSubject(r,t){return t.value.find(a=>a.subject_id===r.subject_id)?.price||""}setPriceSubject(r,t,a){return this.teacherForm.get("subjects").controls?.find(i=>i.value.subject_id===r.subject_id)?.get("price")||null}closeDrawer(){return this._teachersListComponent.matDrawer.close()}toggleEditMode(r=null){null===r?this.editMode=!this.editMode:(this.editMode=r,this.teacherObject&&(this.teacherForm.patchValue({...this.teacherObject}),this.teacherForm.removeControl("password"),this.teacherForm.get("email")?.disable()));const t=[];this.teacherObject?.subjects?.length>0&&this.teacherObject?.subjects.forEach(a=>{t.push(this._formBuilder.group({"teacher-subject_id":[a["teacher-subject_id"]],subject_id:[a.subject_id,[s.kI.required]],teacher_id:[a.teacher_id,[s.kI.required]],price:[a.price]}))}),t.forEach(a=>{this.teacherForm.get("subjects").push(a)}),console.log(this.teacherForm),console.log(this.teacherForm?.get("subjects")),this._changeDetectorRef.markForCheck()}updateContact(){var r=this;return(0,y.Z)(function*(){console.log(r.teacherForm);const t=r.teacherForm.getRawValue();if(console.log(t),r.teacherForm.valid)if("createTeacher"===r.teacher_id&&t)console.log(t),r.apiService.registrationTeacher({email:t.email,password:t.password}).subscribe(a=>{if(console.log(a),a.data){let i={teacher_id:a.data.teacher_id,first_name:r.capitalizeFirstLetter(t.first_name),last_name:r.capitalizeFirstLetter(t.last_name)};r.updateTeacherQuery(i,t.subjects)}else"Email address already registered by another user"===a?.error?.message&&(r.teacherForm.get("email").setErrors({serverError:a?.error?.message}),r._changeDetectorRef.markForCheck())},a=>{console.log(a)});else{let a={teacher_id:r.teacher_id,first_name:r.capitalizeFirstLetter(t.first_name),last_name:r.capitalizeFirstLetter(t.last_name),about_description:t?.about_description||"",degree:t?.degree||"",year_experience:t?.year_experience||"",linkedin_link:t?.linkedin_link||""};r.updateTeacherQuery(a,t.subjects)}else console.log(r.teacherForm)})()}updateTeacherQuery(r,t){var a=this;console.log({_subjects:t}),this.apiService.updateTeacher(r).subscribe(function(){var i=(0,y.Z)(function*(c){console.log(c);let l=!1;if(c.data){if(a.avatarObject){const d=yield a.convertImageFileToWebpFile(a.avatarObject);let g=new FormData;g.append("photo",d,`${c.data.teacher_id}.webp`),g.append("id",c.data.teacher_id),a.apiService.teacherUploadImage(g).subscribe(function(){var h=(0,y.Z)(function*(u){console.log(u),u.data&&(l||(l=!0,a.toggleEditMode(!1),a._router.navigate(["../",c.data.teacher_id],{relativeTo:a._activatedRoute}),a.getTeacherFromServer(),a._changeDetectorRef.markForCheck()))});return function(u){return h.apply(this,arguments)}}(),h=>{console.log(h)})}t.length>0&&t.forEach((d,g)=>{d["teacher-subject_id"]?a.apiService.UpdateCourseAndSubjectToTeacherById({price:d.price,"teacher-subject_id":d["teacher-subject_id"]}).subscribe(u=>{console.log(u),t.length-1===g&&(l||(l=!0,a.toggleEditMode(!1),a._router.navigate(["../",c.data.teacher_id],{relativeTo:a._activatedRoute}),a.getTeacherFromServer(),a._changeDetectorRef.markForCheck()))},u=>{console.log(u)}):a.apiService.addCourseAndSubjectToTeacher({price:d.price,subject_id:d.subject_id,teacher_id:c.data.teacher_id}).subscribe(u=>{console.log(u),t.length-1===g&&(l||(l=!0,a.toggleEditMode(!1),a._router.navigate(["../",c.data.teacher_id],{relativeTo:a._activatedRoute}),a.getTeacherFromServer(),a._changeDetectorRef.markForCheck()))},u=>{console.log(u)})})}});return function(c){return i.apply(this,arguments)}}(),i=>{console.log(i)})}deleteContact(){this._fuseConfirmationService.open({title:"Delete teacherObject",message:"Are you sure you want to delete this teacherObject? This action cannot be undone!",actions:{confirm:{label:"Delete"}}}).afterClosed().subscribe(t=>{})}goBack(){this._router.navigate(["../"],{relativeTo:this._activatedRoute})}uploadAvatar(r){if(!r.length)return;const a=r[0];!["image/jpeg","image/png"].includes(a.type)||(console.log("file -> ",a),this.avatarObject=a)}removeAvatar(){}imageFileTOString(r){return"string"==typeof r?r:this.domSanitizer.bypassSecurityTrustResourceUrl(URL.createObjectURL(r))}capitalizeFirstLetter(r){return r[0].toUpperCase()+r.slice(1).toLowerCase()}convertImageFileToWebpFile(r){return new Promise((t,a)=>{const i=new Image;i.onload=()=>{const c=document.createElement("canvas");c.width=i.naturalWidth,c.height=i.naturalHeight,c.getContext("2d").drawImage(i,0,0),c.toBlob(l=>{let d=new File([l],"my-new-group-image.webp",{type:l.type});t(d)},"image/webp")},i.crossOrigin="anonymous",i.src=URL.createObjectURL(r)})}}j.\u0275fac=function(r){return new(r||j)(e.Y36(m.gz),e.Y36(e.sBO),e.Y36(x),e.Y36(O.s),e.Y36(s.QS),e.Y36(ce.R),e.Y36(e.Qsj),e.Y36(m.F0),e.Y36(se.aV),e.Y36(e.s_b),e.Y36(le.H7))},j.\u0275cmp=e.Xpm({type:j,selectors:[["teachers-details"]],viewQuery:function(r,t){if(1&r&&e.Gf(ue,5),2&r){let a;e.iGM(a=e.CRH())&&(t._avatarFileInput=a.first)}},decls:3,vars:2,consts:[[1,"flex","flex-col","w-full"],[4,"ngIf"],[1,"relative","w-full","h-24","sm:h-48","px-8","sm:px-12","bg-accent-100","dark:bg-accent-700"],[1,"flex","items-center","justify-end","w-full","max-w-3xl","mx-auto","pt-6"],["mat-icon-button","",3,"matTooltip","routerLink"],[1,"text-white",3,"svgIcon"],[1,"relative","flex","flex-col","flex-auto","items-center","p-6","pt-0","sm:p-12","sm:pt-0"],[1,"w-full","max-w-3xl"],[1,"flex","flex-auto","items-end","-mt-16"],[1,"flex","items-center","justify-center","w-32","h-32","rounded-full","overflow-hidden","ring-4","ring-bg-card"],["class","object-cover w-full h-full",3,"src",4,"ngIf"],["class","flex items-center justify-center w-full h-full rounded overflow-hidden uppercase text-8xl font-bold leading-none bg-gray-200 text-gray-600 dark:bg-gray-700 dark:text-gray-200",4,"ngIf"],[1,"flex","items-center","ml-auto","mb-1"],["mat-stroked-button","",3,"click"],[1,"icon-size-5",3,"svgIcon"],[1,"ml-2"],[1,"mt-3","text-4xl","font-bold","truncate"],[1,"flex","flex-col","mt-4","pt-6","border-t","space-y-8"],[1,"absolute","inset-0","object-cover","w-full","h-full",3,"src"],[1,"object-cover","w-full","h-full",3,"src"],[1,"flex","items-center","justify-center","w-full","h-full","rounded","overflow-hidden","uppercase","text-8xl","font-bold","leading-none","bg-gray-200","text-gray-600","dark:bg-gray-700","dark:text-gray-200"],[1,"flex"],[3,"svgIcon"],[1,"min-w-0","ml-6","space-y-1"],[1,"flex","items-center","leading-6"],["target","_blank",1,"hover:underline","text-primary-500",3,"href"],["mat-icon-button","",1,"bg-gray-700","z-[1]",3,"matTooltip","routerLink"],[1,"relative","flex","flex-col","flex-auto","items-center","px-6","sm:px-12"],[3,"formGroup"],[1,"relative","flex","items-center","justify-center","w-32","h-32","rounded-full","overflow-hidden","ring-4","ring-bg-card"],[1,"absolute","inset-0","bg-black","bg-opacity-50","z-10"],[1,"absolute","inset-0","flex","items-center","justify-center","z-20"],["id","avatar-file-input","type","file",1,"absolute","h-0","w-0","opacity-0","invisible","pointer-events-none",3,"multiple","accept","change"],["avatarFileInput",""],["for","avatar-file-input","matRipple","",1,"flex","items-center","justify-center","w-10","h-10","rounded-full","cursor-pointer","hover:bg-hover"],[1,"mt-8"],[1,"w-full",3,"subscriptSizing"],["matPrefix","",1,"hidden","sm:flex","icon-size-5",3,"svgIcon"],["matInput","",3,"formControlName","placeholder","spellcheck"],["matInput","","type","email",3,"formControlName","placeholder","spellcheck"],["class","mt-8",4,"ngIf"],["matInput","","min","0","type","number",3,"formControlName","placeholder","spellcheck"],["matInput","","type","text",3,"formControlName","placeholder","spellcheck"],[1,"flex","flex-col","flex-auto","mt-8","bg-card","shadow","rounded","overflow-hidden"],[1,"p-4","bg-gray-50","dark:bg-gray-700"],[1,"text-lg","font-medium"],[1,"p-4"],["class","flex flex-col gt-xs:flex-row mt-8",4,"ngFor","ngForOf"],[1,"flex","items-center","mt-10","-mx-6","sm:-mx-12","py-4","pr-4","pl-1","sm:pr-12","sm:pl-7","border-t","bg-gray-50","dark:bg-transparent"],["mat-button","",1,"ml-auto",3,"matTooltip","click"],["mat-flat-button","",1,"ml-2",3,"disabled","color","matTooltip","click"],[1,"w-full"],["id","password","matInput","","type","password",3,"formControlName"],["passwordField",""],["mat-icon-button","","type","button","matSuffix","",3,"click"],["class","icon-size-5",3,"svgIcon",4,"ngIf"],[1,"flex","flex-col","gt-xs:flex-row","mt-8"],[1,"font-semibold","mb-2","gt-xs:text-right","gt-xs:min-w-32","gt-xs:mr-4","gt-xs:mb-0"],[1,"flex","flex-col"],["class","flex flex-row justify-between mb-2",4,"ngFor","ngForOf"],[1,"flex","flex-row","justify-between","mb-2"],[1,"",3,"checked","color","change"],["pri",""]],template:function(r,t){1&r&&(e.TgZ(0,"div",0),e.YNc(1,ge,21,11,"ng-container",1),e.YNc(2,Fe,85,50,"ng-container",1),e.qZA()),2&r&&(e.xp6(1),e.Q6J("ngIf",!t.editMode),e.xp6(1),e.Q6J("ngIf",t.editMode))},dependencies:[m.rH,b.lW,b.o6,b.RK,A.oG,Q.d,p.KE,p.hX,p.TO,p.qo,p.R9,k.Hw,F.Nt,Z.wG,J.gM,f.sg,f.O5,s._Y,s.Fj,s.wV,s.JJ,s.JL,s.qQ,s.sg,s.u],encapsulation:2,changeDetection:0});const we=[{path:"",component:T,children:[{path:"",component:x,children:[{path:":id",component:j,canDeactivate:[_]}]}]}];class v{}v.\u0275fac=function(r){return new(r||v)},v.\u0275mod=e.oAB({type:v}),v.\u0275inj=e.cJS({providers:[{provide:Z.sG,useValue:{parse:{dateInput:"D"},display:{dateInput:"DDD",monthYearLabel:"LLL yyyy",dateA11yLabel:"DD",monthYearA11yLabel:"LLLL yyyy"}}}],imports:[m.Bz.forChild(we),b.ot,A.p9,D.FA,Q.t,p.lN,k.Ps,F.c,U.En,N.Tx,Y.Cv,q.Fk,Z.si,M.LD,C.SJ,R.p0,J.AV,E.V,B.m]})}}]);