"use strict";(self.webpackChunkfuse=self.webpackChunkfuse||[]).push([[616],{9616:(U,Z,l)=>{l.r(Z),l.d(Z,{TeacherDetailsModule:()=>D});var O=l(9506),k=l(4859),J=l(811),C=l(9602),R=l(4850),_=l(9549),S=l(7392),T=l(284),B=l(8255),w=l(1572),v=l(4385),m=l(9299),F=l(9476),p=l(5861),e=l(4650),y=l(5830),f=l(6895);function L(i,o){if(1&i&&(e.ynx(0),e.TgZ(1,"div",17)(2,"mat-icon"),e._uU(3,"g_translate"),e.qZA(),e._uU(4),e.qZA(),e.BQk()),2&i){const t=o.$implicit;e.xp6(4),e.hij(" ",t," ")}}function W(i,o){if(1&i&&(e.ynx(0),e.TgZ(1,"div",17)(2,"mat-icon"),e._uU(3,"book"),e.qZA(),e._uU(4),e.qZA(),e.BQk()),2&i){const t=o.$implicit;e.xp6(4),e.hij(" ",t," ")}}function Y(i,o){if(1&i&&(e.ynx(0),e.TgZ(1,"div",22)(2,"div",23),e._uU(3),e.qZA(),e.TgZ(4,"div",24)(5,"span",25),e._uU(6,"\u2022"),e.qZA(),e.TgZ(7,"span",26),e._uU(8),e.qZA()()(),e.BQk()),2&i){const t=o.$implicit;e.xp6(2),e.Q6J("matTooltip","Course Name"),e.xp6(1),e.Oqu(null==t||null==t.subject_id?null:t.subject_id.course_id.title),e.xp6(4),e.Q6J("matTooltip","Subject Name"),e.xp6(1),e.Oqu(null==t||null==t.subject_id?null:t.subject_id.title)}}function E(i,o){if(1&i&&(e.ynx(0),e.TgZ(1,"div",18)(2,"p",19),e._uU(3,"Subjects Offered"),e.qZA(),e.TgZ(4,"div",20),e.YNc(5,Y,9,4,"ng-container",21),e.qZA()(),e.BQk()),2&i){const t=e.oxw();e.xp6(5),e.Q6J("ngForOf",t.teacherDetails["teacher-subject"])("ngForTrackBy",t.trackByFn)}}const H=function(){return["./","add-review"]},G=function(){return["./","add-booking"]};class P{constructor(o,t){this._activatedRoute=o,this.apiService=t,this._activatedRoute.params.subscribe(n=>{this.teacher_id=n.teacher_id,this.orderId=n.orderId,console.log(this.teacher_id),this.teacher_id&&this.getTeacherFromServer()})}getTeacherFromServer(){var o=this;this.apiService.getTeacherById(this.teacher_id).subscribe(function(){var t=(0,p.Z)(function*(n){if(console.log(n),n.data){let r=Array.isArray(n.data)?n.data[0]:n.data;r.rating=Math.round(r.review.reduce((a,c)=>a+c.rating_star||0,0)/r.review?.length||0),console.log(r),o.teacherDetails=r}});return function(n){return t.apply(this,arguments)}}(),t=>{console.log(t)})}onTeacherImgError(o){o.target.src="../../../../assets/images/avatars/dummy user.png"}}P.\u0275fac=function(o){return new(o||P)(e.Y36(m.gz),e.Y36(y.s))},P.\u0275cmp=e.Xpm({type:P,selectors:[["teacher-details"]],decls:35,vars:15,consts:[[1,"flex","flex-col","flex-auto","min-w-0"],[1,"flex-auto","p-4","md:p-10","flex","flex-col"],[1,"flex-[1]","rounded-md","w-full"],[1,"teacherNameWrapper"],[1,"teacherName"],[1,"ratingChip","text-white"],[1,"profilePhoto"],["alt","",1,"teacherImage",3,"src","error"],[1,"mt-4"],[1,"text-[1.5rem]","font-semibold","mb-2"],[1,"subscriptionButtonWrapper"],["mat-fab","","extended","",1,"backgroundDark",3,"routerLink"],[1,"infoWrapper"],[4,"ngFor","ngForOf"],[1,"mt-2"],[4,"ngIf"],["mat-fab","","extended","",1,"backgroundDark","mt-4","w-full",3,"routerLink"],[1,"infoWrapperBox","backgroundDark"],[1,"flex","flex-col"],[1,"text-[1.5rem]","font-semibold"],[1,"min-w-0","space-y-1"],[4,"ngFor","ngForOf","ngForTrackBy"],[1,"flex","items-center","leading-6"],[1,"ml-2.5","font-mono",3,"matTooltip"],[1,"text-md","truncate","text-secondary"],[1,"mx-2"],[1,"font-medium",3,"matTooltip"]],template:function(o,t){1&o&&(e.TgZ(0,"div",0)(1,"div",1)(2,"div",2)(3,"div",3)(4,"div",4),e._uU(5),e.qZA(),e.TgZ(6,"div",5),e._uU(7),e.qZA()(),e.TgZ(8,"div",6)(9,"img",7),e.NdJ("error",function(r){return t.onTeacherImgError(r)}),e.qZA(),e.TgZ(10,"div",4),e._uU(11),e.qZA()(),e.TgZ(12,"div",8)(13,"p",9),e._uU(14,"Teacher Details"),e.qZA(),e.TgZ(15,"p"),e._uU(16),e.qZA()(),e.TgZ(17,"div",10)(18,"button",11)(19,"mat-icon"),e._uU(20,"star"),e.qZA(),e._uU(21," Rate Teacher "),e.qZA()(),e.TgZ(22,"div",8)(23,"p",9),e._uU(24,"Medium"),e.qZA(),e.TgZ(25,"div",12),e.YNc(26,L,5,1,"ng-container",13),e.qZA()(),e.TgZ(27,"div",14)(28,"p",9),e._uU(29,"Education Board"),e.qZA(),e.TgZ(30,"div",12),e.YNc(31,W,5,1,"ng-container",13),e.qZA()(),e.YNc(32,E,6,2,"ng-container",15),e.TgZ(33,"button",16),e._uU(34),e.qZA()()()()),2&o&&(e.xp6(5),e.AsE(" ",null==t.teacherDetails?null:t.teacherDetails.first_name," ",null==t.teacherDetails?null:t.teacherDetails.last_name," "),e.xp6(2),e.hij(" ",(null==t.teacherDetails?null:t.teacherDetails.rating)||0,"/5 "),e.xp6(2),e.Q6J("src",null==t.teacherDetails?null:t.teacherDetails.photo_url,e.LSH),e.xp6(2),e.AsE(" ",null==t.teacherDetails?null:t.teacherDetails.first_name," ",null==t.teacherDetails?null:t.teacherDetails.last_name," "),e.xp6(5),e.Oqu(null==t.teacherDetails?null:t.teacherDetails.about_description),e.xp6(2),e.Q6J("routerLink",e.DdM(13,H)),e.xp6(8),e.Q6J("ngForOf",null==t.teacherDetails?null:t.teacherDetails.language),e.xp6(5),e.Q6J("ngForOf",null==t.teacherDetails?null:t.teacherDetails.board),e.xp6(1),e.Q6J("ngIf",t.teacherDetails&&void 0!==t.teacherDetails["teacher-subject"]&&(null==t.teacherDetails["teacher-subject"]?null:t.teacherDetails["teacher-subject"].length)),e.xp6(1),e.Q6J("routerLink",e.DdM(14,G)),e.xp6(1),e.hij(" ",t.orderId?"Select Schedule":"Book"," "))},dependencies:[m.rH,S.Hw,f.sg,f.O5,k.cs],styles:[".teacherNameWrapper{display:flex;justify-content:space-between;align-items:center;flex-direction:row}.teacherNameWrapper .teacherName{font-size:1rem;margin:0 10px;padding:5px 0;flex:1}.teacherNameWrapper .ratingChip{width:-moz-fit-content;width:fit-content;border-radius:34px;padding:4px .8rem;font-size:.8rem;margin-top:5px;background:var(--color-dark)}.backgroundDark{background:var(--color-dark)!important}.profilePhoto{background:#ffe4e6;border-radius:8px;display:flex;flex-direction:column;justify-content:center;align-items:center;padding:1rem;margin-top:1rem}.profilePhoto img{border-radius:50%;width:13rem;height:13rem;object-fit:cover}.profilePhoto .teacherName{font-size:1rem;padding:5px 0;flex:1;margin-top:10px}.subscriptionButtonWrapper{margin-top:1rem;display:flex;justify-content:space-between;align-items:center;flex-direction:row}.subscriptionButtonWrapper button{font-size:.8rem}.subscriptionButtonWrapper button mat-icon{width:20px!important;height:20px!important}.infoWrapper{display:flex;flex-direction:row;justify-content:flex-start;flex-wrap:wrap}.infoWrapper .infoWrapperBox{padding:.5rem 1rem;display:flex;flex-direction:row;justify-content:center;align-items:center;color:#fff;border-radius:.8rem;margin-right:.5rem;margin-bottom:.5rem}.infoWrapper .infoWrapperBox .mat-icon{color:inherit;margin-right:10px}\n"],encapsulation:2});var K=l(4466),q=l(2340),N=l(7579),M=l(2722),$=l(3120),j=l(877),Q=l(7009),x=l(4006),X=l(3238);function V(i,o){if(1&i&&(e.ynx(0),e.TgZ(1,"mat-option",27),e._uU(2),e.qZA(),e.BQk()),2&i){const t=o.$implicit;e.xp6(1),e.Q6J("value",null==t?null:t.course_id),e.xp6(1),e.Oqu(null==t?null:t.title)}}function ee(i,o){if(1&i&&(e.ynx(0),e.TgZ(1,"mat-option",28)(2,"p"),e._uU(3),e.qZA(),e.TgZ(4,"p"),e._uU(5),e.qZA()(),e.BQk()),2&i){const t=o.$implicit;e.xp6(1),e.Q6J("value",null==t?null:t.subscription_plan_id),e.xp6(2),e.hij("",null==t?null:t.title," "),e.xp6(2),e.AsE("",null==t?null:t.duration_days," Days | Rs ",null==t?null:t.price,"")}}function te(i,o){if(1&i&&(e.ynx(0),e.TgZ(1,"mat-option",27),e._uU(2),e.qZA(),e.BQk()),2&i){const t=o.$implicit;e.xp6(1),e.Q6J("value",null==t?null:t.schedule_id),e.xp6(1),e.AsE("",null==t?null:t.start_time," - ",null==t?null:t.end_time,"")}}function oe(i,o){if(1&i&&(e.TgZ(0,"div",29)(1,"p",30),e._uU(2),e.qZA(),e.TgZ(3,"p",30),e._uU(4),e.qZA()()),2&i){const t=e.oxw();e.xp6(2),e.hij(" Start Date: ",t.getDateString(t.startDate)," "),e.xp6(2),e.hij(" End Date: ",t.getDateString(t.endDate)," ")}}function ne(i,o){1&i&&(e.TgZ(0,"mat-label"),e._uU(1,"Name"),e.qZA())}const re=function(i){return{"mt-6":i}};function ie(i,o){if(1&i){const t=e.EpF();e.ynx(0),e.TgZ(1,"div",39)(2,"button",40),e.NdJ("click",function(){e.CHM(t);const r=e.oxw().index,a=e.oxw(2);return e.KtG(a.removeStudentField(r))}),e._UZ(3,"mat-icon",41),e.qZA()(),e.BQk()}if(2&i){const t=e.oxw().first,n=e.oxw(2);e.xp6(1),e.Q6J("ngClass",e.VKq(3,re,t)),e.xp6(1),e.Q6J("disabled",!!n.orderId),e.xp6(1),e.Q6J("svgIcon","heroicons_solid:trash")}}function ae(i,o){if(1&i){const t=e.EpF();e.ynx(0),e.TgZ(1,"div",36)(2,"mat-form-field",37),e.YNc(3,ne,2,0,"mat-label",21),e.TgZ(4,"input",38),e.NdJ("ngModelChange",function(r){const c=e.CHM(t).index,s=e.oxw(2);return e.KtG(s.group_details[c]=r)}),e.qZA()(),e.YNc(5,ie,4,5,"ng-container",21),e.qZA(),e.BQk()}if(2&i){const t=o.index,n=o.first,r=e.oxw(2);e.xp6(2),e.Q6J("subscriptSizing","dynamic"),e.xp6(1),e.Q6J("ngIf",n),e.xp6(1),e.Q6J("disabled",!!r.orderId)("ngModel",r.group_details[t])("placeholder","Name")("spellcheck",!1),e.xp6(1),e.Q6J("ngIf",(null==r.group_details?null:r.group_details.length)>2)}}function se(i,o){if(1&i){const t=e.EpF();e.TgZ(0,"div",42),e.NdJ("click",function(){e.CHM(t);const r=e.oxw(2);return e.KtG(r.addStudentField())}),e._UZ(1,"mat-icon",41),e.TgZ(2,"span",43),e._uU(3,"Add an student"),e.qZA()()}2&i&&(e.xp6(1),e.Q6J("svgIcon","heroicons_solid:plus-circle"))}function le(i,o){if(1&i&&(e.ynx(0),e.TgZ(1,"div",31)(2,"div",32),e._uU(3,"Group students Name"),e.qZA(),e.TgZ(4,"div",33),e.YNc(5,ae,6,7,"ng-container",34),e.qZA(),e.YNc(6,se,4,1,"div",35),e.qZA(),e.BQk()),2&i){const t=e.oxw();e.xp6(5),e.Q6J("ngForOf",t.group_details)("ngForTrackBy",t.trackByIdx),e.xp6(1),e.Q6J("ngIf",t.group_details.length<5&&!t.orderId)}}function ce(i,o){if(1&i){const t=e.EpF();e.TgZ(0,"button",44),e.NdJ("click",function(){e.CHM(t);const r=e.oxw();return e.KtG(r.processToChangeTeacher())}),e._uU(1," Send Transfer Request "),e.qZA()}if(2&i){const t=e.oxw();e.Q6J("disabled",t.isBookButtonDisable())}}function de(i,o){if(1&i&&(e.TgZ(0,"span",46),e._uU(1),e.qZA()),2&i){const t=e.oxw(2);e.xp6(1),e.hij("\u20b9",t.getPrice(),"")}}function pe(i,o){if(1&i){const t=e.EpF();e.TgZ(0,"button",44),e.NdJ("click",function(){e.CHM(t);const r=e.oxw();return e.KtG(r.instaMojo())}),e._uU(1," Book "),e.YNc(2,de,2,1,"span",45),e.qZA()}if(2&i){const t=e.oxw();e.Q6J("disabled",t.isBookButtonDisable()),e.xp6(2),e.Q6J("ngIf",null==t.selectedSubscriptionPlanDetails?null:t.selectedSubscriptionPlanDetails.price)}}function ue(i,o){1&i&&(e.TgZ(0,"div",47),e._UZ(1,"mat-spinner",48),e.qZA())}class A{constructor(o,t,n,r,a,c){var s=this;this._activatedRoute=o,this.apiService=t,this._authService=n,this._changeDetectorRef=r,this._snackBar=a,this._router=c,this.booking_type="single",this.group_details=[],this._unsubscribeAll=new N.x,this.isLoading=!1,this.scheduleDateFilter=d=>{const u=(new Date(d)||new Date).getDay(),g=this.teacherDetails?.schedule?.find(h=>h.schedule_id==this.selectedScheduleId)?.days?.map(h=>this.getWeekNumber(h))||null;return!!g&&g.some(h=>h===u)&&Boolean(new Date(d)>new Date)},this.paymentFailed=d=>{console.log("paymentFailed => ",d),alert(d.error.description)},this.razorpayResponse=function(){var d=(0,p.Z)(function*(u,g){console.log(u.razorpay_payment_id);let h={teacher_id:s.teacher_id,student_id:s.student_id,subscription_plan_id:s.selectedSubscriptionPlanDetails?.subscription_plan_id,total_price:s.getPrice(),razorpay_payment_id:u.razorpay_payment_id,razorpay_order_id:g};try{const b=yield s.apiService.studentSubscribeToPlan(h);console.log("studentSubscribeToPlanResponse => ",b),b?.data?s.addBooking(b?.data?.subscription_teacher_user_id):s._snackBar.open(b?.error?.message?b?.error?.message:"Something went wrong! Try again","",{horizontalPosition:"center",verticalPosition:"top",duration:3e3,panelClass:["error-toast"]})}catch(b){console.error(b),s._snackBar.open(b?.error?.message?b?.error?.message:"Something went wrong! Try again","",{horizontalPosition:"center",verticalPosition:"top",duration:3e3,panelClass:["error-toast"]})}});return function(u,g){return d.apply(this,arguments)}}(),this._activatedRoute.params.subscribe(function(){var d=(0,p.Z)(function*(u){s.teacher_id=u.teacher_id,s.orderId=u.orderId,console.log(s.teacher_id),s.teacher_id&&(yield s.getTeacherFromServer(),yield s.getAllCourseFromServer()),s.orderId&&(yield s.getOrderFromServer())});return function(u){return d.apply(this,arguments)}}()),this._authService.user.pipe((0,M.R)(this._unsubscribeAll)).subscribe(d=>{console.log({user:d}),d&&d?.student_id&&(this.user=d,this.student_id=d?.student_id,this.address=d?.home_address||"")})}ngOnInit(){this.initMap()}initMap(){var o=this;return(0,p.Z)(function*(){const t=yield o.getLatitudeLongitude();let n,r;t.success&&t?.latitude&&t?.longitude?(n=t?.latitude,r=t?.longitude):(n=20.5937,r=78.9629);const a=new google.maps.Map(document.getElementById("map-container"),{center:{lat:n,lng:r},zoom:13,mapTypeId:"roadmap"}),c=document.getElementById("pac-input"),s=new google.maps.places.SearchBox(c);console.log(google.maps.ControlPosition.TOP_LEFT),a.controls[google.maps.ControlPosition.TOP_LEFT].push(c),a.addListener("bounds_changed",()=>{s.setBounds(a.getBounds())});let d=[];s.addListener("places_changed",()=>{const u=s.getPlaces();if(console.log("places -> ",u),0==u.length)return;o.address=u[0].formatted_address,o.longitude=u[0].geometry.location.lng(),o.latitude=u[0].geometry.location.lat(),d.forEach(h=>{h.setMap(null)}),d=[];const g=new google.maps.LatLngBounds;u.forEach(h=>{if(!h.geometry||!h.geometry.location)return void console.log("Returned place contains no geometry");const b={url:h.icon,size:new google.maps.Size(71,71),origin:new google.maps.Point(0,0),anchor:new google.maps.Point(17,34),scaledSize:new google.maps.Size(25,25)};d.push(new google.maps.Marker({map:a,icon:b,title:h.name,position:h.geometry.location})),h.geometry.viewport?g.union(h.geometry.viewport):g.extend(h.geometry.location)}),a.fitBounds(g),o._changeDetectorRef.detectChanges()})})()}updateInfoWindow(o,t,n,r,a){o.setContent(t),o.setPosition(n),o.open({_map:r,anchor:a,shouldFocus:!1})}ngOnDestroy(){this._unsubscribeAll.next(null),this._unsubscribeAll.complete()}getTeacherFromServer(){var o=this;return(0,p.Z)(function*(){const t=yield o.apiService.getTeacherById(o.teacher_id).toPromise();if(console.log(t),t.data){let n=Array.isArray(t.data)?t.data[0]:t.data;console.log(n),o.teacherDetails=n}else console.error("getTeacherByIdResponse => ",t)})()}getAllSubscriptionsFromServer(){var o=this;return(0,p.Z)(function*(){if(o.teacher_id&&o.student_id){const t=yield o.apiService.getStudentSubscribedToTeacherPlan(o.teacher_id,o.student_id).toPromise();if(t.data){let n=t.data.map(r=>({...r,isConnected:Boolean(r["subscription-teacher-user"]?.length)}));o.subscriptionsList=[...n],console.log(o.subscriptionsList),o._changeDetectorRef.markForCheck()}else console.log(t)}})()}getAllCourseFromServer(){var o=this;return(0,p.Z)(function*(){try{const t=yield o.apiService.getCourseByTeacherId(o.teacher_id).toPromise();if(!t.data)throw t;{let r=t.data.map(a=>a?.subject_id?.course_id)?.filter(a=>a?.is_course_active).reduce((a,c)=>a?.some(s=>s.course_id===c.course_id)?a:[...a,c],[]);o.courseList=r,console.log(r)}}catch(t){console.error(t),o._snackBar.open(t?.error?.message?t?.error?.message:"Something went wrong! Try again","",{horizontalPosition:"center",verticalPosition:"top",duration:3e3,panelClass:["error-toast"]})}})()}getOrderFromServer(){var o=this;return(0,p.Z)(function*(){try{const t=yield o.apiService.getOrderById(o.orderId);if(console.log("getOrderByIdResponse => ",t),!t.data)throw t;o.orderDetails=t.data,o.booking_type=o.orderDetails?.booking_type,o.address=o.orderDetails?.address,o.selectedSubscriptionId=o.orderDetails?.subscription_teacher_user_id?.subscription_plan_id,o.selectedCourseId=o.orderDetails?.course_id,o.onChangeCourse(o.selectedCourseId,!0),console.log("selectedSubscriptionId => ",o.selectedSubscriptionId),o._changeDetectorRef.detectChanges()}catch(t){console.error(t),o._snackBar.open(t?.error?.message?t?.error?.message:"Something went wrong! Try again","",{horizontalPosition:"center",verticalPosition:"top",duration:3e3,panelClass:["error-toast"]})}})()}onChangeSchedule(o){if(console.log(o.value),this.teacherDetails?.schedule.some(t=>t.schedule_id==o.value)){this.selectedScheduleDetails=this.teacherDetails?.schedule.find(n=>n.schedule_id==o.value);let t=this.selectedScheduleDetails.days.map(n=>this.getWeekNumber(n));console.log({days:t}),this.startDate="",this.endDate="",this._changeDetectorRef.detectChanges()}}onChangeSubscription(o){o&&!o.value&&(o={value:o}),console.log(o.value),this.selectedSubscriptionPlanDetails=this.subscriptionsList.find(t=>t.subscription_plan_id==o.value),this.selectedSubscriptionPlanDetails&&(this.startDate="",this.endDate="",this._changeDetectorRef.detectChanges())}onChangeCourse(o,t){t||(this.subscriptionsList=[],this.selectedSubscriptionId=null,this.selectedSubscriptionPlanDetails=null),this.selectedScheduleId=null,this.selectedScheduleDetails=null,o&&!o.value&&(o={value:o}),console.log(o.value),this.courseList?.some(n=>n.course_id==o.value)&&(this.subscriptionsList=this.courseList?.find(n=>n.course_id==o.value)?.["subscription-plan"],console.log("this.subscriptionsList => ",this.subscriptionsList),this.startDate="",this.endDate="",this._changeDetectorRef.detectChanges())}handleDateClick(o){console.log("_event => ",o),console.log("date click => "+o.targetElement.value);const t={dateStr:o.targetElement.value};if(this.selectedCourseId)if(this.selectedSubscriptionId)if(this.selectedScheduleId){var n=new Date(t.dateStr),r=new Date;Boolean(n>r)?(this.selectedScheduleDetails.days.some(a=>a===this.getWeekName(new Date(t.dateStr).getDay()))?(this.startDate=t.dateStr,this.endDate=new Date(new Date(t.dateStr).setDate(new Date(t.dateStr).getDate()+this.selectedSubscriptionPlanDetails?.duration_days)).toISOString().slice(0,10)):(this.startDate="",this.endDate="",this._snackBar.open("Please select available date.","",{horizontalPosition:"center",verticalPosition:"top",duration:3e3,panelClass:["error-toast"]})),this._changeDetectorRef.detectChanges()):this._snackBar.open("Please choose a future date.","",{horizontalPosition:"center",verticalPosition:"top",duration:3e3,panelClass:["error-toast"]})}else this._snackBar.open("Please select schedule time.","",{horizontalPosition:"center",verticalPosition:"top",duration:3e3,panelClass:["error-toast"]});else this._snackBar.open("Please select subscription.","",{horizontalPosition:"center",verticalPosition:"top",duration:3e3,panelClass:["error-toast"]});else this._snackBar.open("Please select course.","",{horizontalPosition:"center",verticalPosition:"top",duration:3e3,panelClass:["error-toast"]})}processToBook(){var o=this;return(0,p.Z)(function*(){const t={start_date:o.startDate,end_date:o.endDate,start_time:o.selectedScheduleDetails.start_time,end_time:o.selectedScheduleDetails.end_time,teacher_id:o.teacher_id},n=yield o.apiService.checkBookTeacherScheduleSlot(t);if(console.log("addReviewResponse => ",n),n.success){const a=yield o.apiService.razorpayCreateOrderId(100*o.getPrice());if(console.log("razorpayCreateOrderIdResponse => ",a),!a?.success)return void(n?.description?o._snackBar.open(n?.description,"",{horizontalPosition:"center",verticalPosition:"top",duration:4e3,panelClass:["error-toast"]}):o._snackBar.open("Something went wrong! Try again","",{horizontalPosition:"center",verticalPosition:"top",duration:3e3,panelClass:["error-toast"]}));var r={key:q.N.razorpay_Key,order_id:a?.id,amount:100*o.getPrice(),currency:"INR",name:"Bizorclass",description:"Subscribe to "+o.selectedSubscriptionPlanDetails?.title,prefill:{name:o.user?.first_name+" "+o.user?.last_name,email:o.user?.email,contact:o.user?.phone_number},theme:{color:"#b5245f"}};try{console.log("razorpay options => ",r);let c=yield $.Checkout.open(r);console.log(c),o.razorpayResponse(c.response,a?.id)}catch(c){let s=JSON.parse(c.code);console.log(s),s?.description?o._snackBar.open(s?.description,"",{horizontalPosition:"center",verticalPosition:"top",duration:4e3,panelClass:["error-toast"]}):o._snackBar.open("Something went wrong! Try again","",{horizontalPosition:"center",verticalPosition:"top",duration:3e3,panelClass:["error-toast"]})}}else n?.error?.message?o._snackBar.open(n?.error?.message,"",{horizontalPosition:"center",verticalPosition:"top",duration:4e3,panelClass:["error-toast"]}):o._snackBar.open("Something went wrong! Try again","",{horizontalPosition:"center",verticalPosition:"top",duration:3e3,panelClass:["error-toast"]})})()}processForRazorpay(o){}addBooking(o){var t=this;return(0,p.Z)(function*(){t.isLoading=!0,t._changeDetectorRef.detectChanges();const n={start_date:t.startDate,end_date:t.endDate,start_time:t.selectedScheduleDetails.start_time,end_time:t.selectedScheduleDetails.end_time,student_id:t.student_id,teacher_id:t.teacher_id,schedule_id:t.selectedScheduleId,booking_type:t.booking_type,group_details:t.group_details,address:t.address,latitude:t.latitude,longitude:t.longitude,subscription_teacher_user_id:o,course_id:t.selectedCourseId};console.log(n);try{const r=yield t.apiService.bookTeacherScheduleSlot(n);console.log("addReviewResponse => ",r),r?.data?(t._snackBar.open("Slot booking successfully.","",{horizontalPosition:"center",verticalPosition:"top",duration:3e3,panelClass:["success-toast"]}),t._router.navigate(["../"])):t._snackBar.open(r?.error?.message?r?.error?.message:"Something went wrong! Try again","",{horizontalPosition:"center",verticalPosition:"top",duration:3e3,panelClass:["error-toast"]}),t.isLoading=!1,t._changeDetectorRef.detectChanges()}catch(r){console.error(r),t._snackBar.open(r?.error?.message?r?.error?.message:"Something went wrong! Try again","",{horizontalPosition:"center",verticalPosition:"top",duration:3e3,panelClass:["error-toast"]}),t.isLoading=!1,t._changeDetectorRef.detectChanges()}})()}instaMojo(){var o=this;return(0,p.Z)(function*(){const t={start_date:o.startDate,end_date:o.endDate,start_time:o.selectedScheduleDetails.start_time,end_time:o.selectedScheduleDetails.end_time,teacher_id:o.teacher_id},n=yield o.apiService.checkBookTeacherScheduleSlot(t);if(console.log("checkBookTeacherScheduleSlotResponse => ",n),n.success)try{const r=yield o.apiService.createInstamojoPaymentRequest(o.getPrice(),o.user?.first_name,o.user?.email,o.user?.phone_number);if(console.log("createInstamojoPaymentRequestResponse => ",r),!r?.data?.longurl)throw r;Instamojo.configure({amount:10,handlers:{onOpen:a=>o.InstamojoOnOpen(a),onSuccess:a=>o.InstamojoOnSuccess(a),onFailure:a=>o.InstamojoOnFailure(a)}}),Instamojo.open(r?.data?.longurl)}catch(r){console.error(r),o._snackBar.open("Something went wrong! Try again","",{horizontalPosition:"center",verticalPosition:"top",duration:3e3,panelClass:["error-toast"]})}else n?.error?.message?o._snackBar.open(n?.error?.message,"",{horizontalPosition:"center",verticalPosition:"top",duration:4e3,panelClass:["error-toast"]}):o._snackBar.open("Something went wrong! Try again","",{horizontalPosition:"center",verticalPosition:"top",duration:3e3,panelClass:["error-toast"]})})()}InstamojoOnSuccess(o){var t=this;return(0,p.Z)(function*(){console.log("InstamojoOnSuccess => ",o),console.log("InstamojoOnSuccess paymentId => ",o?.paymentId);let n={teacher_id:t.teacher_id,student_id:t.student_id,subscription_plan_id:t.selectedSubscriptionPlanDetails?.subscription_plan_id,total_price:t.getPrice(),razorpay_payment_id:o?.paymentId,razorpay_order_id:o?.paymentId};try{const r=yield t.apiService.studentSubscribeToPlan(n);console.log("studentSubscribeToPlanResponse => ",r),r?.data?t.addBooking(r?.data?.subscription_teacher_user_id):t._snackBar.open(r?.error?.message?r?.error?.message:"Something went wrong! Try again","",{horizontalPosition:"center",verticalPosition:"top",duration:3e3,panelClass:["error-toast"]})}catch(r){console.error(r),t._snackBar.open(r?.error?.message?r?.error?.message:"Something went wrong! Try again","",{horizontalPosition:"center",verticalPosition:"top",duration:3e3,panelClass:["error-toast"]})}})()}InstamojoOnFailure(o){console.log("InstamojoOnFailure => ",o),this._snackBar.open("Payment failure! Try again","",{horizontalPosition:"center",verticalPosition:"top",duration:3e3,panelClass:["error-toast"]})}InstamojoOnOpen(o){console.log("InstamojoOnOpenResponse => ",o)}processToChangeTeacher(){var o=this;return(0,p.Z)(function*(){o.isLoading=!0,o._changeDetectorRef.detectChanges();const t={order_id:o.orderId,old_teacher_id:o.orderDetails?.teacher_id?.teacher_id,old_start_date:o.orderDetails?.start_date,old_end_date:o.orderDetails?.end_date,old_start_time:o.orderDetails?.start_time,old_end_time:o.orderDetails?.end_time,old_schedule_id:o.orderDetails?.schedule_id,new_teacher_id:o.teacher_id,new_start_date:o.startDate,new_end_date:o.endDate,new_start_time:o.selectedScheduleDetails.start_time,new_end_time:o.selectedScheduleDetails.end_time,new_schedule_id:o.selectedScheduleId};console.log(t);try{const n=yield o.apiService.sendChangeRequest(t);console.log("sendChangeRequestResponse => ",n),n?.data?(o._snackBar.open("Transfer request sent successfully.","",{horizontalPosition:"center",verticalPosition:"top",duration:3e3,panelClass:["success-toast"]}),o._router.navigate(["student","home"])):o._snackBar.open(n?.error?.message?n?.error?.message:"Something went wrong! Try again","",{horizontalPosition:"center",verticalPosition:"top",duration:3e3,panelClass:["error-toast"]}),o.isLoading=!1,o._changeDetectorRef.detectChanges()}catch(n){console.error(n),o._snackBar.open(n?.error?.message?n?.error?.message:"Something went wrong! Try again","",{horizontalPosition:"center",verticalPosition:"top",duration:3e3,panelClass:["error-toast"]}),o.isLoading=!1,o._changeDetectorRef.detectChanges()}})()}changeGroupType(o){this.orderId||(this.group_details="single"===o?[]:[`${this.user?.first_name} ${this.user?.last_name}`])}inputChange(o,t){console.log(t.target.value),this.group_details[o]=t.target.value}addStudentField(){this.group_details.push("")}removeStudentField(o){this.group_details.splice(o,1)}isBookButtonDisable(){if("single"===this.booking_type)return!Boolean(this.startDate&&this.endDate&&this.address&&this.longitude&&this.latitude);if(this.group_details.length){let o=!1;return this.group_details.forEach(t=>{t||(o=!0)}),Boolean(this.startDate&&this.endDate&&this.address&&this.longitude&&this.latitude)||(o=!0),o}return!0}getPrice(){return"single"===this.booking_type?this.selectedSubscriptionPlanDetails?.price:this.selectedSubscriptionPlanDetails?.price*this.group_details.length}getActiveSchedules(){return this.teacherDetails?.schedule?.filter(o=>o?.is_active)||[]}getWeekNumber(o){return["sunday","monday","tuesday","wednesday","thursday","friday","saturday"].findIndex(n=>n===o)}getWeekName(o){return["sunday","monday","tuesday","wednesday","thursday","friday","saturday"][o]}onTeacherImgError(o){o.target.src="../../../../assets/images/avatars/dummy user.png"}getLatitudeLongitude(){return new Promise((o,t)=>{navigator.geolocation?navigator.geolocation.getCurrentPosition(n=>{const r=n.coords.latitude,a=n.coords.longitude;console.log("Latitude:",r),console.log("Longitude:",a),o({success:!0,latitude:r,longitude:a})},n=>{console.log("Error:",n.message),o({success:!1})}):console.log("Geolocation is not supported by this browser.")})}trackByIdx(o,t){return o}getDateString(o){return new Date(o).toDateString()}}A.\u0275fac=function(o){return new(o||A)(e.Y36(m.gz),e.Y36(y.s),e.Y36(j.e),e.Y36(e.sBO),e.Y36(Q.ux),e.Y36(m.F0))},A.\u0275cmp=e.Xpm({type:A,selectors:[["add-booking-subscription"]],decls:52,vars:24,consts:[[1,"flex","flex-col","flex-auto","min-w-0"],[1,"flex-auto","p-4","md:p-10","flex","flex-col"],[1,"flex-[1]","rounded-md","w-full"],[1,"font-medium","text-[1.4rem]","mb-2"],[1,"flex","flex-col","gt-xs:flex-row"],[1,"flex-auto","gt-xs:pr-3"],[3,"ngModel","disabled","ngModelChange","selectionChange"],[4,"ngFor","ngForOf"],["matPrefix","",1,"icon-size-5",3,"svgIcon"],[1,"flex-auto","w-full"],["matInput","",3,"matDatepickerFilter","matDatepicker","focus","dateChange"],["matIconSuffix","",3,"for"],["picker",""],["class","mb-4",4,"ngIf"],[1,"text-[1.5rem]","font-semibold","my-2"],[1,"bookingTypeWrapper"],[1,"flex","items-center","pl-4","border","border-gray-200","rounded","dark:border-gray-700",3,"click"],["id","bordered-radio-1","type","radio","value","single","name","bordered-radio",1,"w-4","h-4","text-blue-600","bg-gray-100","border-gray-300","focus:ring-blue-500","dark:focus:ring-blue-600","dark:ring-offset-gray-800","focus:ring-2","dark:bg-gray-700","dark:border-gray-600",3,"disabled","ngModel","ngModelChange"],["for","bordered-radio-1",1,"w-full","py-4","ml-2","text-sm","font-medium","text-gray-900","dark:text-gray-300"],["id","bordered-radio-2","type","radio","value","group","name","bordered-radio",1,"w-4","h-4","text-blue-600","bg-gray-100","border-gray-300","focus:ring-blue-500","dark:focus:ring-blue-600","dark:ring-offset-gray-800","focus:ring-2","dark:bg-gray-700","dark:border-gray-600",3,"disabled","ngModel","ngModelChange"],["for","bordered-radio-2",1,"w-full","py-4","ml-2","text-sm","font-medium","text-gray-900","dark:text-gray-300"],[4,"ngIf"],[1,"flex","mt-4","mapWrapper"],["id","pac-input","type","text","placeholder","Search Box",1,"controls"],["id","map-container",1,"mapContainer"],["class","backgroundLight text-white font-bold py-2 px-4 rounded-full w-full mt-4 disabled:opacity-50",3,"disabled","click",4,"ngIf"],["class","loadingWrapper",4,"ngIf"],[3,"value"],[1,"subscriptionOptionItem",3,"value"],[1,"mb-4"],[1,"text-[0.8rem]","font-semibold","my-2"],[1,"flex","flex-col","w-full","lg:w-2/4","lg:pl-8","mt-6"],[1,"text-[1rem]","font-medium","tracking-tight","mb-4"],[1,"space-y-4"],[4,"ngFor","ngForOf","ngForTrackBy"],["class","group inline-flex items-center mt-2 -ml-4 py-2 px-4 rounded cursor-pointer",3,"click",4,"ngIf"],[1,"flex"],[1,"flex-auto","w-full",3,"subscriptSizing"],["matInput","","type","text",3,"disabled","ngModel","placeholder","spellcheck","ngModelChange"],[1,"flex","items-center","w-10","pl-2",3,"ngClass"],["mat-icon-button","","matTooltip","Remove",1,"w-8","h-8","min-h-8",3,"disabled","click"],[1,"icon-size-5",3,"svgIcon"],[1,"group","inline-flex","items-center","mt-2","-ml-4","py-2","px-4","rounded","cursor-pointer",3,"click"],[1,"ml-2","font-medium","text-secondary","group-hover:underline"],[1,"backgroundLight","text-white","font-bold","py-2","px-4","rounded-full","w-full","mt-4","disabled:opacity-50",3,"disabled","click"],["style","color: inherit !important;",4,"ngIf"],[2,"color","inherit !important"],[1,"loadingWrapper"],["color","red"]],template:function(o,t){if(1&o){const n=e.EpF();e.TgZ(0,"div",0)(1,"div",1)(2,"div",2)(3,"div",3),e._uU(4," Booking "),e.qZA(),e.TgZ(5,"div",4)(6,"mat-form-field",5)(7,"mat-label"),e._uU(8,"Select Course"),e.qZA(),e.TgZ(9,"mat-select",6),e.NdJ("ngModelChange",function(a){return t.selectedCourseId=a})("selectionChange",function(a){return t.onChangeCourse(a,!1)}),e.YNc(10,V,3,2,"ng-container",7),e.qZA(),e._UZ(11,"mat-icon",8),e.qZA(),e.TgZ(12,"mat-form-field",5)(13,"mat-label"),e._uU(14,"Select Subscription"),e.qZA(),e.TgZ(15,"mat-select",6),e.NdJ("ngModelChange",function(a){return t.selectedSubscriptionId=a})("selectionChange",function(a){return t.onChangeSubscription(a)}),e.YNc(16,ee,6,4,"ng-container",7),e.qZA(),e._UZ(17,"mat-icon",8),e.qZA(),e.TgZ(18,"mat-form-field",5)(19,"mat-label"),e._uU(20,"Select Time Schedule"),e.qZA(),e.TgZ(21,"mat-select",6),e.NdJ("ngModelChange",function(a){return t.selectedScheduleId=a})("selectionChange",function(a){return t.onChangeSchedule(a)}),e.YNc(22,te,3,3,"ng-container",7),e.qZA(),e._UZ(23,"mat-icon",8),e.qZA()(),e.TgZ(24,"mat-form-field",9)(25,"mat-label"),e._uU(26,"Choose a date"),e.qZA(),e.TgZ(27,"input",10),e.NdJ("focus",function(){e.CHM(n);const a=e.MAs(32);return e.KtG(a.open())})("dateChange",function(a){return t.handleDateClick(a)}),e.qZA(),e.TgZ(28,"mat-hint"),e._uU(29,"MM/DD/YYYY"),e.qZA(),e._UZ(30,"mat-datepicker-toggle",11)(31,"mat-datepicker",null,12),e.qZA(),e.YNc(33,oe,5,2,"div",13),e.TgZ(34,"p",14),e._uU(35,"Booking Type"),e.qZA(),e.TgZ(36,"div",15)(37,"div",16),e.NdJ("click",function(){return t.changeGroupType("single")}),e.TgZ(38,"input",17),e.NdJ("ngModelChange",function(a){return t.booking_type=a}),e.qZA(),e.TgZ(39,"label",18),e._uU(40,"Individual"),e.qZA()(),e.TgZ(41,"div",16),e.NdJ("click",function(){return t.changeGroupType("group")}),e.TgZ(42,"input",19),e.NdJ("ngModelChange",function(a){return t.booking_type=a}),e.qZA(),e.TgZ(43,"label",20),e._uU(44,"Group"),e.qZA()()(),e.YNc(45,le,7,3,"ng-container",21),e.TgZ(46,"div",22),e._UZ(47,"input",23)(48,"div",24),e.qZA(),e.YNc(49,ce,2,1,"button",25),e.YNc(50,pe,3,2,"button",25),e.YNc(51,ue,2,0,"div",26),e.qZA()()()}if(2&o){const n=e.MAs(32);e.xp6(9),e.Q6J("ngModel",t.selectedCourseId)("disabled",!!t.orderId),e.xp6(1),e.Q6J("ngForOf",t.courseList),e.xp6(1),e.Q6J("svgIcon","mat_outline:menu_book"),e.xp6(4),e.Q6J("ngModel",t.selectedSubscriptionId)("disabled",!!t.orderId||!t.selectedCourseId),e.xp6(1),e.Q6J("ngForOf",t.subscriptionsList),e.xp6(1),e.Q6J("svgIcon","heroicons_solid:credit-card"),e.xp6(4),e.Q6J("ngModel",t.selectedScheduleId)("disabled",!t.selectedCourseId),e.xp6(1),e.Q6J("ngForOf",t.getActiveSchedules()),e.xp6(1),e.Q6J("svgIcon","heroicons_solid:clock"),e.xp6(4),e.Q6J("matDatepickerFilter",t.scheduleDateFilter)("matDatepicker",n),e.xp6(3),e.Q6J("for",n),e.xp6(3),e.Q6J("ngIf",t.startDate&&t.endDate),e.xp6(5),e.Q6J("disabled",!!t.orderId)("ngModel",t.booking_type),e.xp6(4),e.Q6J("disabled",!!t.orderId)("ngModel",t.booking_type),e.xp6(3),e.Q6J("ngIf","group"===t.booking_type),e.xp6(4),e.Q6J("ngIf",t.orderId),e.xp6(1),e.Q6J("ngIf",!t.orderId),e.xp6(1),e.Q6J("ngIf",t.isLoading)}},dependencies:[S.Hw,f.mk,f.sg,f.O5,x.Fj,x._,x.JJ,x.On,k.RK,C.Mq,C.hl,C.nW,_.KE,_.hX,_.bx,_.qo,_.R9,T.Nt,v.gD,X.ey,w.Ou],styles:[".teacherName{font-size:1rem;margin:10px 0;padding:5px 0;flex:1;font-weight:600}.StarWrapper{display:flex;flex-direction:row;flex-wrap:nowrap}.StarWrapper div{margin:.5rem;cursor:pointer}.messageWrapper{display:flex;flex-direction:column;margin:1rem 0}.fc{max-width:1100px;margin:0 auto}.fc-col-header,.fc-daygrid-body,.fc-scrollgrid-sync-table{width:100%!important}.fc-header-toolbar{display:flex;flex-direction:row;flex-wrap:wrap;font-size:.7rem}.fc-non-business{background:rgba(143,223,130,.2784313725)!important}.bookingTypeWrapper{display:flex}.bookingTypeWrapper div{flex:50%}.subscriptionOptionItem{border-bottom:1px solid rgba(0,0,0,.0784313725);padding:5px 16px}.subscriptionOptionItem:last-of-type{border-bottom:none}.backgroundLight{background:var(--color-light)}.mapWrapper .mapContainer{width:100%;height:20rem}.mapWrapper #description{font-family:Roboto;font-size:15px;font-weight:300}.mapWrapper #infowindow-content .title{font-weight:700}.mapWrapper #infowindow-content{display:none}.mapWrapper #map #infowindow-content{display:inline}.mapWrapper .pac-card{background-color:#fff;border:0;border-radius:2px;box-shadow:0 1px 4px -1px #0000004d;margin:10px;font:400 18px Roboto,Arial,sans-serif;overflow:hidden;font-family:Roboto;padding:0}.mapWrapper #pac-container{padding-bottom:12px;margin-right:12px}.mapWrapper .pac-controls{display:inline-block;padding:5px 11px}.mapWrapper .pac-controls label{font-family:Roboto;font-size:13px;font-weight:300}.mapWrapper #pac-input{background-color:#fff;position:relative!important;top:unset!important;left:unset!important;padding:10px;width:100%;z-index:1;border-radius:6px;border:1px solid rgb(226,232,240);font-size:12px}.mapWrapper #pac-input:focus{border-color:#4d90fe}.mapWrapper #title{color:#fff;background-color:#4d90fe;font-size:25px;font-weight:500;padding:6px 12px}.mapWrapper #target{width:345px}.loadingWrapper{width:100%;height:100%;position:fixed;top:0;left:0;background:rgba(0,0,0,.1019607843);z-index:12;display:flex;align-items:center;justify-content:center}.loadingWrapper svg{stroke:var(--color-light)!important}\n"],encapsulation:2,changeDetection:0});const ge=function(i){return{fill:i}};function he(i,o){if(1&i){const t=e.EpF();e.ynx(0),e.TgZ(1,"div",10),e.NdJ("click",function(){const a=e.CHM(t).$implicit,c=e.oxw();return e.KtG(c.reviewObject.rating_star=a)}),e.O4$(),e.TgZ(2,"svg",11),e._UZ(3,"path",12),e.qZA()(),e.BQk()}if(2&i){const t=o.$implicit,n=e.oxw();e.xp6(1),e.Q6J("ngStyle",e.VKq(1,ge,n.reviewObject.rating_star>=t?"gold":"inherit"))}}function me(i,o){if(1&i&&(e.TgZ(0,"p",13),e._uU(1),e.qZA()),2&i){const t=e.oxw();e.xp6(1),e.Oqu(t.messageHelperText)}}const _e=function(){return[1,2,3,4,5]};class I{constructor(o,t,n,r,a,c,s){this._activatedRoute=o,this.apiService=t,this._authService=n,this._changeDetectorRef=r,this._snackBar=a,this._router=c,this._location=s,this._unsubscribeAll=new N.x,this.reviewObject={rating_star:0,text:""},this.messageHelperText="",this._activatedRoute.params.subscribe(d=>{this.teacher_id=d.teacher_id,console.log(this.teacher_id),this.teacher_id&&this.getTeacherFromServer()}),this._authService.user.pipe((0,M.R)(this._unsubscribeAll)).subscribe(d=>{d&&d?.student_id&&(this.user=d,this.student_id=d?.student_id)})}ngOnInit(){}ngOnDestroy(){this._unsubscribeAll.next(null),this._unsubscribeAll.complete()}getTeacherFromServer(){var o=this;this.apiService.getTeacherById(this.teacher_id).subscribe(function(){var t=(0,p.Z)(function*(n){if(console.log(n),n.data){let r=Array.isArray(n.data)?n.data[0]:n.data;console.log(r),o.teacherDetails=r,o._changeDetectorRef.detectChanges()}});return function(n){return t.apply(this,arguments)}}(),t=>{console.log(t)})}checkMessage(){this.messageHelperText=this.reviewObject.text.trim()?"":"Please enter review message."}clickOnSubmit(){var o=this;return(0,p.Z)(function*(){if(o.checkMessage(),!o.messageHelperText){const t={student_id:o.student_id,teacher_id:o.teacher_id,text:o.reviewObject.text,rating_star:o.reviewObject.rating_star};try{const n=yield o.apiService.addReview(t);console.log("addReviewResponse => ",n),n?.data?(o._snackBar.open("Review added successfully.","",{horizontalPosition:"center",verticalPosition:"top",duration:3e3,panelClass:["success-toast"]}),o.reviewObject={rating_star:0,text:""},o.messageHelperText="",o._location.back()):o._snackBar.open(n?.error?.message?n?.error?.message:"Something went wrong! Try again","",{horizontalPosition:"center",verticalPosition:"top",duration:3e3,panelClass:["error-toast"]})}catch(n){console.error(n),n?.error?.message&&o._snackBar.open(n?.error?.message,"",{horizontalPosition:"center",verticalPosition:"top",duration:3e3,panelClass:["error-toast"]}),o._snackBar.open("Something went wrong! Try again","",{horizontalPosition:"center",verticalPosition:"top",duration:3e3,panelClass:["error-toast"]})}}})()}onTeacherImgError(o){o.target.src="../../../../assets/images/avatars/dummy user.png"}}function fe(i,o){1&i&&(e.TgZ(0,"p",13),e._uU(1,"Connected"),e.qZA())}function be(i,o){if(1&i){const t=e.EpF();e.TgZ(0,"p",14),e.NdJ("click",function(){e.CHM(t);const r=e.oxw().$implicit,a=e.oxw(2);return e.KtG(a.connectToPlan(r))}),e._uU(1,"Buy Now"),e.qZA()}}function ve(i,o){if(1&i&&(e.ynx(0),e.TgZ(1,"div",8)(2,"div")(3,"p",9),e._uU(4),e.qZA(),e.TgZ(5,"p",10),e._uU(6),e.qZA()(),e.TgZ(7,"div"),e.YNc(8,fe,2,0,"p",11),e.YNc(9,be,2,0,"p",12),e.qZA()(),e.BQk()),2&i){const t=o.$implicit;e.xp6(4),e.Oqu(null==t?null:t.title),e.xp6(2),e.hij("\u20b9 ",null==t?null:t.price,""),e.xp6(2),e.Q6J("ngIf",null==t?null:t.isConnected),e.xp6(1),e.Q6J("ngIf",!(null!=t&&t.isConnected))}}function ye(i,o){if(1&i&&(e.ynx(0),e.TgZ(1,"div",4)(2,"p",5),e._uU(3,"Available Plans"),e.qZA(),e.TgZ(4,"div",6),e.YNc(5,ve,10,4,"ng-container",7),e.qZA()(),e.BQk()),2&i){const t=e.oxw();e.xp6(5),e.Q6J("ngForOf",t.subscriptionsList)("ngForTrackBy",t.trackByFn)}}I.\u0275fac=function(o){return new(o||I)(e.Y36(m.gz),e.Y36(y.s),e.Y36(j.e),e.Y36(e.sBO),e.Y36(Q.ux),e.Y36(m.F0),e.Y36(f.Ye))},I.\u0275cmp=e.Xpm({type:I,selectors:[["add-review"]],decls:12,vars:6,consts:[[1,"flex","flex-col","flex-auto","min-w-0"],[1,"flex-auto","p-4","md:p-10","flex","flex-col"],[1,"flex-[1]","rounded-md","w-full"],[1,"teacherName"],[1,"StarWrapper"],[4,"ngFor","ngForOf"],[1,"messageWrapper"],["rows","5","placeholder","Add review here ...",1,"backgroundLight","block","p-2.5","w-full","text-sm","text-black","bg-gray-50","rounded-lg","border","border-gray-300","dark:bg-gray-700","dark:border-gray-600","dark:placeholder-gray-400","dark:text-white",3,"ngModel","ngModelChange"],["class","text-red-600",4,"ngIf"],[1,"backgroundLight","text-white","font-bold","py-2","px-4","rounded-full","w-full",3,"click"],[3,"ngStyle","click"],["xmlns","http://www.w3.org/2000/svg","viewBox","0 0 24 24","fill","inherit",1,"w-8","h-8"],["fill-rule","evenodd","d","M10.788 3.21c.448-1.077 1.976-1.077 2.424 0l2.082 5.007 5.404.433c1.164.093 1.636 1.545.749 2.305l-4.117 3.527 1.257 5.273c.271 1.136-.964 2.033-1.96 1.425L12 18.354 7.373 21.18c-.996.608-2.231-.29-1.96-1.425l1.257-5.273-4.117-3.527c-.887-.76-.415-2.212.749-2.305l5.404-.433 2.082-5.006z","clip-rule","evenodd"],[1,"text-red-600"]],template:function(o,t){1&o&&(e.TgZ(0,"div",0)(1,"div",1)(2,"div",2)(3,"div",3),e._uU(4),e.qZA(),e.TgZ(5,"div",4),e.YNc(6,he,4,3,"ng-container",5),e.qZA(),e.TgZ(7,"div",6)(8,"textarea",7),e.NdJ("ngModelChange",function(r){return t.reviewObject.text=r})("ngModelChange",function(){return t.checkMessage()}),e.qZA(),e.YNc(9,me,2,1,"p",8),e.qZA(),e.TgZ(10,"button",9),e.NdJ("click",function(){return t.clickOnSubmit()}),e._uU(11," Submit "),e.qZA()()()()),2&o&&(e.xp6(4),e.AsE(" ",null==t.teacherDetails?null:t.teacherDetails.first_name," ",null==t.teacherDetails?null:t.teacherDetails.last_name," "),e.xp6(2),e.Q6J("ngForOf",e.DdM(5,_e)),e.xp6(2),e.Q6J("ngModel",t.reviewObject.text),e.xp6(1),e.Q6J("ngIf",t.messageHelperText))},dependencies:[f.sg,f.O5,f.PC,x.Fj,x.JJ,x.On],styles:[".teacherName{font-size:1rem;margin:10px 0;padding:5px 0;flex:1;font-weight:600}.StarWrapper{display:flex;flex-direction:row;flex-wrap:nowrap;fill:var(--color-dark)}.StarWrapper div{margin:.5rem;cursor:pointer}.messageWrapper{display:flex;flex-direction:column;margin:1rem 0}.backgroundLight{background:var(--color-light)!important}\n"],encapsulation:2,changeDetection:0});class z{constructor(o,t,n,r,a){var c=this;this._activatedRoute=o,this.apiService=t,this._authService=n,this._changeDetectorRef=r,this._snackBar=a,this._unsubscribeAll=new N.x,this.paymentFailed=s=>{console.log("paymentFailed => ",s),alert(s.error.description)},this.razorpayResponse=function(){var s=(0,p.Z)(function*(d){console.log(d.razorpay_payment_id);let u={teacher_id:c.teacher_id,student_id:c.student_id,subscription_plan_id:c.selectedPlan?.subscription_plan_id,razorpay_payment_id:d.razorpay_payment_id,total_price:c.selectedPlan?.price};try{const g=yield c.apiService.studentSubscribeToPlan(u);console.log("studentSubscribeToPlanResponse => ",g),g?.data?(c._snackBar.open("Plan connected successfully.","",{horizontalPosition:"center",verticalPosition:"top",duration:3e3,panelClass:["success-toast"]}),c.getAllSubscriptionsFromServer()):c._snackBar.open(g?.error?.message?g?.error?.message:"Something went wrong! Try again","",{horizontalPosition:"center",verticalPosition:"top",duration:3e3,panelClass:["error-toast"]})}catch(g){console.error(g),g?.error?.message&&c._snackBar.open(g?.error?.message,"",{horizontalPosition:"center",verticalPosition:"top",duration:3e3,panelClass:["error-toast"]}),c._snackBar.open("Something went wrong! Try again","",{horizontalPosition:"center",verticalPosition:"top",duration:3e3,panelClass:["error-toast"]})}});return function(d){return s.apply(this,arguments)}}(),this._activatedRoute.params.subscribe(s=>{this.teacher_id=s.teacher_id,console.log(this.teacher_id),this.teacher_id&&this.getAllSubscriptionsFromServer()}),this._authService.user.pipe((0,M.R)(this._unsubscribeAll)).subscribe(s=>{s&&s?.student_id&&(this.user=s,this.student_id=s?.student_id,this.getAllSubscriptionsFromServer())})}ngOnInit(){}ngOnDestroy(){this._unsubscribeAll.next(null),this._unsubscribeAll.complete()}getAllSubscriptionsFromServer(){var o=this;this.teacher_id&&this.student_id&&this.apiService.getStudentSubscribedToTeacherPlan(this.teacher_id,this.student_id).subscribe(function(){var t=(0,p.Z)(function*(n){if(n.data){let r=n.data.map(a=>({...a,isConnected:Boolean(a["subscription-teacher-user"]?.length)}));o.subscriptionsList=[...r],console.log(o.subscriptionsList),o._changeDetectorRef.markForCheck()}else console.log(n)});return function(n){return t.apply(this,arguments)}}(),t=>{console.log(t)})}connectToPlan(o){this.selectedPlan=o,this.processForRazorpay({key:q.N.razorpay_Key,amount:100*this.selectedPlan.price,currency:"INR",name:"Bizorclass",description:"Subscribe to "+this.selectedPlan?.title,handler:this.razorpayResponse,prefill:{name:this.user?.first_name+" "+this.user?.last_name,email:this.user?.email,contact:this.user?.phone_number}})}processForRazorpay(o){var t=new Razorpay(o);t.on("payment.failed",this.paymentFailed),t.open()}onTeacherImgError(o){o.target.src="../../../../assets/images/avatars/dummy user.png"}}z.\u0275fac=function(o){return new(o||z)(e.Y36(m.gz),e.Y36(y.s),e.Y36(j.e),e.Y36(e.sBO),e.Y36(Q.ux))},z.\u0275cmp=e.Xpm({type:z,selectors:[["subscriptions"]],decls:4,vars:1,consts:[[1,"flex","flex-col","flex-auto","min-w-0"],[1,"flex-auto","p-4","md:p-10","flex","flex-col"],[1,"flex-[1]","rounded-md","w-full"],[4,"ngIf"],[1,"flex","flex-col"],[1,"text-[1.5rem]","font-semibold"],[1,"min-w-0","space-y-1"],[4,"ngFor","ngForOf","ngForTrackBy"],[1,"flex","justify-between","items-center","p-4","bg-blue-500","rounded-lg","mb-2"],[1,"text-[1.2rem]","font-semibold","text-white"],[1,"text-[1.2rem]","font-semibold"],["class","text-[1.2rem] font-semibold text-gray-200",4,"ngIf"],["class","text-[1.2rem] font-semibold text-white cursor-pointer",3,"click",4,"ngIf"],[1,"text-[1.2rem]","font-semibold","text-gray-200"],[1,"text-[1.2rem]","font-semibold","text-white","cursor-pointer",3,"click"]],template:function(o,t){1&o&&(e.TgZ(0,"div",0)(1,"div",1)(2,"div",2),e.YNc(3,ye,6,2,"ng-container",3),e.qZA()()()),2&o&&(e.xp6(3),e.Q6J("ngIf",t.subscriptionsList&&(null==t.subscriptionsList?null:t.subscriptionsList.length)))},dependencies:[f.sg,f.O5],encapsulation:2,changeDetection:0});const xe=[{path:"",component:P},{path:"subscriptions",component:z},{path:"add-review",component:I},{path:"add-booking",component:A}];class D{}D.\u0275fac=function(o){return new(o||D)},D.\u0275mod=e.oAB({type:D}),D.\u0275inj=e.cJS({imports:[m.Bz.forChild(xe),S.Ps,K.m,k.ot,J.vV,C.FA,R.t,_.lN,S.Ps,T.c,O.En,B.Tx,v.LD,v.LD,w.Cq,F.z]})},3120:(U,Z,l)=>{l.r(Z),l.d(Z,{Checkout:()=>C,CheckoutWeb:()=>J});var O=l(5861),k=l(7423);class J extends k.Uw{constructor(){super({name:"Checkout",platforms:["web"]})}echo(_){return(0,O.Z)(function*(){return console.log("ECHO",_),_})()}open(_){return(0,O.Z)(function*(){return console.log(_),new Promise((S,T)=>{var B,w,v=_;v.handler=function(e){console.log(e.razorpay_payment_id),S({response:e})},v["modal.ondismiss"]=function(){T(JSON.stringify({code:2,description:"Payment Canceled by User"}))};var m=0;v.hasOwnProperty("retry")&&!0===v.retry.enabled&&(m=v.retry.max_count);var F=document.getElementsByTagName("script")[0],p=document.createElement("script");p.id="rzp-jssdk",p.setAttribute("src","https://checkout.razorpay.com/v1/checkout.js"),null===(B=F.parentNode)||void 0===B||B.appendChild(p),p.addEventListener("load",()=>{try{(w=new window.Razorpay(v)).open(),w.on("payment.failed",e=>{var y;(m-=1)<0&&(console.log(e),null===(y=F.parentNode)||void 0===y||y.removeChild(p),T(e.error))})}catch(e){T({response:e})}})})})()}}const C=(0,k.fo)("Checkout",{web:()=>Promise.resolve().then(l.bind(l,3120)).then(R=>new R.CheckoutWeb)})}}]);