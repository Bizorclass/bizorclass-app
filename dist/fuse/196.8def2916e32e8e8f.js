"use strict";(self.webpackChunkfuse=self.webpackChunkfuse||[]).push([[196],{8196:(V,T,i)=>{i.r(T),i.d(T,{ScheduleModule:()=>r});var A=i(9299),v=i(5861),b=i(7579),M=i(2722),h=i(7274),e=i(4650),Z=i(5830),U=i(7009),y=i(284),u=i(9549),f=i(4859),p=i(7392),g=i(2371),S=i(4385),k=i(3238),C=i(455),_=i(4006);class d{constructor(t,n,l,a){this.data=t,this.dialogRef=n,this.apiService=l,this._snackBar=a,this.scheduleForm={start_time:"",end_time:"",teacher_id:"",is_active:!1,days:[]},console.log({data:t}),this.scheduleForm={...this.scheduleForm,...t},console.log("this.scheduleForm => ",this.scheduleForm)}saveSchedule(){var t=this;return(0,v.Z)(function*(){if(t.scheduleForm?.schedule_id)try{const n=yield t.apiService.updateSchedule(t.scheduleForm).toPromise();if(console.log(n),!n.data)throw n;t.closeModal(!0),t._snackBar.open("Schedule updated successfully.","",{horizontalPosition:"center",verticalPosition:"top",duration:3e3,panelClass:["success-toast"]})}catch(n){console.error(n),t._snackBar.open(n?.error?.message?n?.error?.message:"Something went wrong! Try again","",{horizontalPosition:"center",verticalPosition:"top",duration:3e3,panelClass:["error-toast"]})}else{const n={...t.scheduleForm};delete n?.schedule_id;try{const l=yield t.apiService.addSchedule(n).toPromise();if(console.log(l),!l.data)throw l;t.closeModal(!0),t._snackBar.open("Schedule added successfully.","",{horizontalPosition:"center",verticalPosition:"top",duration:3e3,panelClass:["success-toast"]})}catch(l){console.error(l),t._snackBar.open(l?.error?.message?l?.error?.message:"Something went wrong! Try again","",{horizontalPosition:"center",verticalPosition:"top",duration:3e3,panelClass:["error-toast"]})}}})()}closeModal(t){this.dialogRef.close({flag:t})}}d.\u0275fac=function(t){return new(t||d)(e.Y36(h.WI),e.Y36(h.so),e.Y36(Z.s),e.Y36(U.ux))},d.\u0275cmp=e.Xpm({type:d,selectors:[["fuse-confirmation-dialog"]],decls:58,vars:10,consts:[[1,"relative","flex","flex-col","w-full","h-full"],[1,"flex","flex-col","flex-auto","items-center","sm:items-start","mb-4"],[1,"flex","flex-col","w-full","items-center","sm:items-start","mt-4","sm:mt-0","space-y-1","text-center","sm:text-left"],[1,"text-xl","leading-6","font-medium","mb-4"],[1,"mt-8","w-full"],[1,"w-full"],["matInput","","name","Start Time","placeholder","--:-- --","readonly","",3,"max","ngModel","ngxMatTimepicker","ngModelChange"],["matSuffix","",3,"click"],["startTimePicker",""],["matInput","","name","End Time","placeholder","--:-- --","readonly","",3,"disabled","min","ngModel","ngxMatTimepicker","ngModelChange"],["endTimePicker",""],["appearance","fill",1,"w-full"],["multiple","",3,"ngModel","ngModelChange"],["value","monday"],["value","tuesday"],["value","wednesday"],["value","thursday"],["value","friday"],["value","saturday"],["value","sunday"],["appearance","fill",1,"w-full","flex","flex-col"],[3,"ngModel","ngModelChange"],[1,"flex","items-center","justify-center","sm:justify-end","space-x-3","bg-gray-50","dark:bg-black","dark:bg-opacity-10"],["mat-stroked-button","",3,"click"],["mat-flat-button","",1,"bg-[#b5245f]","text-white",3,"disabled","click"]],template:function(t,n){if(1&t){const l=e.EpF();e.TgZ(0,"div",0)(1,"div",1),e.ynx(2),e.TgZ(3,"div",2),e.ynx(4),e.TgZ(5,"div",3),e._uU(6," Add Schedule "),e.qZA(),e.BQk(),e.ynx(7),e.TgZ(8,"div",4)(9,"mat-form-field",5)(10,"mat-label"),e._uU(11,"Start time"),e.qZA(),e.TgZ(12,"input",6),e.NdJ("ngModelChange",function(s){return n.scheduleForm.start_time=s}),e.qZA(),e.TgZ(13,"mat-icon",7),e.NdJ("click",function(){e.CHM(l);const s=e.MAs(16);return e.KtG(s.open())}),e._uU(14," watch_later "),e.qZA()(),e._UZ(15,"ngx-mat-timepicker",null,8),e.qZA(),e.TgZ(17,"div",4)(18,"mat-form-field",5)(19,"mat-label"),e._uU(20,"End time"),e.qZA(),e.TgZ(21,"input",9),e.NdJ("ngModelChange",function(s){return n.scheduleForm.end_time=s}),e.qZA(),e.TgZ(22,"mat-icon",7),e.NdJ("click",function(){e.CHM(l);const s=e.MAs(25);return e.KtG(s.open())}),e._uU(23," watch_later "),e.qZA()(),e._UZ(24,"ngx-mat-timepicker",null,10),e.qZA(),e.TgZ(26,"div",4)(27,"mat-form-field",11)(28,"mat-label"),e._uU(29,"Days"),e.qZA(),e.TgZ(30,"mat-select",12),e.NdJ("ngModelChange",function(s){return n.scheduleForm.days=s}),e.TgZ(31,"mat-option",13),e._uU(32,"Monday"),e.qZA(),e.TgZ(33,"mat-option",14),e._uU(34,"Tuesday"),e.qZA(),e.TgZ(35,"mat-option",15),e._uU(36,"Wednesday"),e.qZA(),e.TgZ(37,"mat-option",16),e._uU(38,"Thursday"),e.qZA(),e.TgZ(39,"mat-option",17),e._uU(40,"Friday"),e.qZA(),e.TgZ(41,"mat-option",18),e._uU(42,"Saturday"),e.qZA(),e.TgZ(43,"mat-option",19),e._uU(44,"Sunday"),e.qZA()()()(),e.TgZ(45,"div",4)(46,"div",20)(47,"mat-label"),e._uU(48,"Active"),e.qZA(),e.TgZ(49,"mat-slide-toggle",21),e.NdJ("ngModelChange",function(s){return n.scheduleForm.is_active=s}),e.qZA()()(),e.BQk(),e.qZA(),e.BQk(),e.qZA(),e.ynx(50),e.TgZ(51,"div",22),e.ynx(52),e.TgZ(53,"button",23),e.NdJ("click",function(){return n.closeModal(!1)}),e._uU(54," cancel "),e.qZA(),e.BQk(),e.ynx(55),e.TgZ(56,"button",24),e.NdJ("click",function(){return n.saveSchedule()}),e._uU(57," Save "),e.qZA(),e.BQk(),e.qZA(),e.BQk(),e.qZA()}if(2&t){const l=e.MAs(16),a=e.MAs(25);e.xp6(12),e.Q6J("max",n.scheduleForm.end_time?n.scheduleForm.end_time:null)("ngModel",n.scheduleForm.start_time)("ngxMatTimepicker",l),e.xp6(9),e.Q6J("disabled",!n.scheduleForm.start_time)("min",n.scheduleForm.start_time)("ngModel",n.scheduleForm.end_time)("ngxMatTimepicker",a),e.xp6(9),e.Q6J("ngModel",n.scheduleForm.days),e.xp6(19),e.Q6J("ngModel",n.scheduleForm.is_active),e.xp6(7),e.Q6J("disabled",!(n.scheduleForm.start_time&&n.scheduleForm.end_time&&(null==n.scheduleForm.days?null:n.scheduleForm.days.length)>0))}},dependencies:[y.Nt,u.KE,u.hX,u.R9,f.lW,p.Hw,g.ft,g.Bi,S.gD,k.ey,C.Rr,_.Fj,_.JJ,_.On],styles:["@media (min-width: 960px){.fuse-confirmation-dialog-panel{width:32rem}}.fuse-confirmation-dialog-panel .mat-mdc-dialog-container .mat-mdc-dialog-surface{padding:0!important}\n"],encapsulation:2});var F=i(877),c=i(7155),w=i(6895);function D(o,t){1&o&&(e.TgZ(0,"th",22),e._uU(1," No. "),e.qZA())}function N(o,t){if(1&o&&(e.TgZ(0,"td",23),e._uU(1),e.qZA()),2&o){const n=t.$implicit;e.xp6(1),e.hij(" ",null==n?null:n.index," ")}}function B(o,t){1&o&&(e.TgZ(0,"th",22),e._uU(1," Start\xa0Time "),e.qZA())}function Q(o,t){if(1&o&&(e.TgZ(0,"td",23),e._uU(1),e.qZA()),2&o){const n=t.$implicit,l=e.oxw(2);e.xp6(1),e.hij(" ",l.time24To12(null==n?null:n.start_time)," ")}}function J(o,t){1&o&&(e.TgZ(0,"th",22),e._uU(1," End\xa0Time "),e.qZA())}function Y(o,t){if(1&o&&(e.TgZ(0,"td",23),e._uU(1),e.qZA()),2&o){const n=t.$implicit,l=e.oxw(2);e.xp6(1),e.hij(" ",l.time24To12(null==n?null:n.end_time)," ")}}function q(o,t){1&o&&(e.TgZ(0,"th",22),e._uU(1," Days "),e.qZA())}function P(o,t){if(1&o&&(e.TgZ(0,"td",23),e._uU(1),e.qZA()),2&o){const n=t.$implicit,l=e.oxw(2);e.xp6(1),e.hij(" ",l.htmlDays(null==n?null:n.days)||"--"," ")}}function I(o,t){1&o&&(e.TgZ(0,"th",22),e._uU(1," Status "),e.qZA())}function R(o,t){1&o&&(e.TgZ(0,"div",26)(1,"div",27),e._uU(2,"In-Active"),e.qZA()())}function j(o,t){1&o&&(e.TgZ(0,"div",28)(1,"div",27),e._uU(2,"Active"),e.qZA()())}function z(o,t){if(1&o&&(e.TgZ(0,"td",23),e.YNc(1,R,3,0,"div",24),e.YNc(2,j,3,0,"div",25),e.qZA()),2&o){const n=t.$implicit;e.xp6(1),e.Q6J("ngIf",!(null!=n&&n.is_active)),e.xp6(1),e.Q6J("ngIf",null==n?null:n.is_active)}}function E(o,t){1&o&&(e.TgZ(0,"th",22),e._uU(1," Actions "),e.qZA())}function H(o,t){if(1&o){const n=e.EpF();e.TgZ(0,"td",23)(1,"button",29),e.NdJ("click",function(){const s=e.CHM(n).$implicit,x=e.oxw(2);return e.KtG(x.createSchedule(s))}),e._uU(2,"Edit"),e.qZA()()}2&o&&(e.xp6(1),e.Q6J("color","primary"))}function $(o,t){1&o&&e._UZ(0,"tr",30)}function L(o,t){1&o&&e._UZ(0,"tr",31)}function G(o,t){if(1&o&&(e.ynx(0),e.TgZ(1,"section",10)(2,"table",11),e.ynx(3,12),e.YNc(4,D,2,0,"th",13),e.YNc(5,N,2,1,"td",14),e.BQk(),e.ynx(6,15),e.YNc(7,B,2,0,"th",13),e.YNc(8,Q,2,1,"td",14),e.BQk(),e.ynx(9,16),e.YNc(10,J,2,0,"th",13),e.YNc(11,Y,2,1,"td",14),e.BQk(),e.ynx(12,17),e.YNc(13,q,2,0,"th",13),e.YNc(14,P,2,1,"td",14),e.BQk(),e.ynx(15,18),e.YNc(16,I,2,0,"th",13),e.YNc(17,z,3,2,"td",14),e.BQk(),e.ynx(18,19),e.YNc(19,E,2,0,"th",13),e.YNc(20,H,3,1,"td",14),e.BQk(),e.YNc(21,$,1,0,"tr",20),e.YNc(22,L,1,0,"tr",21),e.qZA()(),e.BQk()),2&o){const n=e.oxw();e.xp6(2),e.Q6J("dataSource",n.dataSource),e.xp6(19),e.Q6J("matHeaderRowDef",n.displayedColumns),e.xp6(1),e.Q6J("matRowDefColumns",n.displayedColumns)}}function W(o,t){1&o&&(e.TgZ(0,"div",32),e._uU(1," There are no Schedule! "),e.qZA())}class m{constructor(t,n,l){this.apiService=t,this._authService=n,this.dialog=l,this.user=null,this.displayedColumns=["index","start_time","end_time","days","status","actions"],this.dataSource=[],this.isLoading=!1,this._unsubscribeAll=new b.x,this._authService.user.pipe((0,M.R)(this._unsubscribeAll)).subscribe(a=>{this.user=a,a&&a?.teacher_id&&this.getAllScheduleByTeacherIdFromServer()})}ngOnDestroy(){this._unsubscribeAll.next(null),this._unsubscribeAll.complete()}getAllScheduleByTeacherIdFromServer(){var t=this;this.isLoading=!0,this.apiService.getAllScheduleByTeacherId(this.user.teacher_id).subscribe(function(){var n=(0,v.Z)(function*(l){console.log(l),l.data&&(t.dataSource=l.data.map((s,x)=>({...s,index:x+1})),console.log(t.dataSource)),t.isLoading=!1});return function(l){return n.apply(this,arguments)}}(),n=>{console.log(n),this.isLoading=!1})}createSchedule(t){this.dialog.open(d,{width:"min(350px, 90%)",data:{start_time:t?.start_time?this.time24To12(t?.start_time):"",end_time:t?.end_time?this.time24To12(t?.end_time):"",teacher_id:this.user.teacher_id,schedule_id:t?.schedule_id||null,is_active:t?.is_active||!1,days:t?.days||[]}}).afterClosed().subscribe(l=>{console.log("The dialog was closed"),console.log({result:l}),l?.flag&&this.getAllScheduleByTeacherIdFromServer()})}htmlDays(t){return t.map(n=>`${n.charAt(0).toUpperCase()}${n.slice(1)}`).join(",\xa0")}time24To12(t){let n=t.split(":"),l=parseInt(n[0],10),s=l>=12?"pm":"am";return l%=12,l=l||12,l+":"+n[1]+" "+s}}m.\u0275fac=function(t){return new(t||m)(e.Y36(Z.s),e.Y36(F.e),e.Y36(h.uw))},m.\u0275cmp=e.Xpm({type:m,selectors:[["schedule"]],decls:14,vars:3,consts:[[1,"flex","flex-col","flex-auto","min-w-0"],[1,"flex-auto","p-6","sm:p-10"],[1,"flex","flex-row","sm:flex-row","md:flex-row","flex-auto","justify-between","border-b","pb-4"],[1,"text-4xl","font-extrabold","tracking-tight","leading-none"],[1,"flex","items-center","sm:mt-0","md:mt-0"],["mat-flat-button","",1,"ml-4","bg-[#b5245f]","text-white",3,"click"],[3,"svgIcon"],[1,"ml-2","mr-1"],[4,"ngIf","ngIfElse"],["noSchedules",""],["tabindex","0",1,"overflow-auto"],["mat-table","",1,"mat-elevation-z8",3,"dataSource"],["matColumnDef","index"],["mat-header-cell","",4,"matHeaderCellDef"],["mat-cell","",4,"matCellDef"],["matColumnDef","start_time"],["matColumnDef","end_time"],["matColumnDef","days"],["matColumnDef","status"],["matColumnDef","actions"],["mat-header-row","",4,"matHeaderRowDef"],["mat-row","",4,"matRowDef","matRowDefColumns"],["mat-header-cell",""],["mat-cell",""],["class","flex justify-center items-center m-1 px-2 py-1 border border-red-300 rounded-full bg-red-200 text-base text-red-700 font-medium",4,"ngIf"],["class","flex justify-center items-center m-1 px-2 py-1 border border-green-300 rounded-full bg-green-200 text-base text-green-700 font-medium",4,"ngIf"],[1,"flex","justify-center","items-center","m-1","px-2","py-1","border","border-red-300","rounded-full","bg-red-200","text-base","text-red-700","font-medium"],[1,"flex-initial","max-w-full","leading-none","text-xs","font-normal","whitespace-nowrap"],[1,"flex","justify-center","items-center","m-1","px-2","py-1","border","border-green-300","rounded-full","bg-green-200","text-base","text-green-700","font-medium"],["mat-button","",3,"color","click"],["mat-header-row",""],["mat-row",""],[1,"p-8","sm:p-16","border-t","text-4xl","font-semibold","tracking-tight","text-center"]],template:function(t,n){if(1&t&&(e.TgZ(0,"div",0)(1,"div",1)(2,"div",2)(3,"div")(4,"div",3),e._uU(5," Schedule "),e.qZA()(),e.TgZ(6,"div",4)(7,"button",5),e.NdJ("click",function(){return n.createSchedule(null)}),e._UZ(8,"mat-icon",6),e.TgZ(9,"span",7),e._uU(10,"Add"),e.qZA()()()(),e.YNc(11,G,23,3,"ng-container",8),e.YNc(12,W,2,0,"ng-template",null,9,e.W1O),e.qZA()()),2&t){const l=e.MAs(13);e.xp6(8),e.Q6J("svgIcon","heroicons_outline:plus"),e.xp6(3),e.Q6J("ngIf",(null==n.dataSource?null:n.dataSource.length)||n.isLoading)("ngIfElse",l)}},dependencies:[c.BZ,c.fO,c.as,c.w1,c.Dz,c.nj,c.ge,c.ev,c.XQ,c.Gk,f.lW,p.Hw,w.O5],encapsulation:2});var K=i(4466);const X=[{path:"",component:m}];class r{}r.\u0275fac=function(t){return new(t||r)},r.\u0275mod=e.oAB({type:r}),r.\u0275inj=e.cJS({imports:[A.Bz.forChild(X),c.p0,y.c,f.ot,p.Ps,u.lN,g.Yy,S.LD,C.rP,K.m]})}}]);